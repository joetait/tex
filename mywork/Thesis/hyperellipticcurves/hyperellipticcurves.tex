\chapter{Bases for the spaces of (poly)differentials on hyperelliptic curves}\label{chapterhyperellipticcurves}


In this chapter we recall the definition and basic details of hyperelliptic curves, and then go on to compute bases for the spaces of holomorphic differentials and polydifferentials, see Propositions \ref{prophyperellipticbasispnot2} and \ref{propbasishyperellipticp=2}.
The primary use of these concepts is to form a foundation for the next chapter.
Furthermore, we also use the bases computed to illustrate all the facets of our main theorem in Chapter 5.
The various attributes of hyperelliptic curves differ greatly according to whether the characteristic of the base field is two or not, and as such we split this chapter into two sections, considering these cases separately.


Before going in to the details of hyperelliptic curves we recall that a curve $X$ is hyperelliptic if there exists a finite separable morphism $\pi \colon X \ra \PP_k^1$ of degree two.\index{Hyperelliptic curve}
Every hyperelliptic curve has a hyperelliptic involution $\sigma$ which permutes the elements of $\pi^{-1}(a)$ for each $a \in \mathbb P_k^1$ (except for the finite number of points $a$ for which $\pi^{-1}(a)$ has order one), and the quotient curve $X /\langle \sigma \rangle$ is isomorphic to $\mathbb P_k^1$.
We let $X$ be a hyperelliptic curve of genus $g$ throughout the chapter, and we fix such a map $\pi$, which is unique up to an automorphism of $\PP_k^1$ \cite[Prop.\ 7.4.29]{liu}.
We also let $P_a$ and $P_a'$ denote the unique elements of $\pi^{-1}(a)$ for any point $a \in \mathbb P_k^1$ that is not a branch point.
If $a \in \mathbb P_k^1$ is a branch point we denote the unique point in $\pi^{-1}(a)$ by $P_a$.
We define $D_a$ to be the divisor $\pi^*\left([a]\right)$ for any $a \in \mathbb P_k^1$, and hence
    \begin{equation*}
    D_a= 
        \begin{cases}
         2[P_a] & \text{if $a$ is a branch point}, \\
         [P_a] + [P_a'] & \text{otherwise.}
        \end{cases}
    \end{equation*}

We also have for $x \in k(x)  = K(\mathbb P_k^1) \subseteq K(X)$, that
    \begin{equation}\label{equationdivxpis2}
    \di (x)  = D_0 - D_\infty,
    \end{equation}
regardless of characteristic.
Furthermore, the strong Riemann-Hurwitz formula (Theorem \ref{theoremdetailedhurwitz}) gives us
    \[
    \di_X (dx) = \pi^*( \di_{\mathbb P^1_k}(dx)) + R,
    \]
and since $\di_{\PP_k^1}(dx) = -2[\infty]$, it follows that $\pi^*(\di_{\PP_k^1}(dx)) = -2D_\infty$.
Hence we conclude that
    \begin{equation}\label{equationdifferentialdivisor}
    \di(dx) = R - 2D_\infty.
    \end{equation}


\section{Characteristic unequal to 2}\label{charneq2}

In this section we assume that $\cha(k) = p \neq 2$.
Then the extension $K(X)$ of $K(\mathbb P_k^1) = k(x)$ corresponding to $ \pi \colon X \ra \mathbb P_k^1$ will be $k(x,y)$, where $y$ satisfies
    \begin{equation}\label{equationdefiningequationpnot2}
    y^2 = f(x)
    \end{equation}
for some polynomial $f(x) \in k[x]$ which has no repeated roots and is of degree $2g+1$ or $2g+2$ \cite[Prop.\ 7.4.24]{liu}.
Moreover, by applying an automorphism of $\mathbb P_k^1$ if necessary, we can and will assume that $f(x)$ is monic.

If we let $d_f:=\deg(f(x))$ then 
    \begin{equation}\label{equationexpansionoff(x)}
    f(x) = \prod_{i=1}^{d_f} (x-a_i) = x^{d_f} + b_{d_f - 1}x^{d_f-1} + \ldots + b_0,
    \end{equation}
for some $a_i, b_i \in k$.
We now show that the $a_i \in \AA_k^1$, and possibly $\infty \in \PP_k^1$, are the branch points of $\pi$.

Firstly, observe that by the Riemann-Hurwitz formula, Corollary \ref{corhurwitzformula},
    \[ 
    \deg(R) = 2g -2 +2\cdot 2 = 2g + 2.
    \]
Since $\pi$ is of degree two and $\cha (k) \neq 2$ it is only tamely ramified, and it follows that the coefficient of each ramification point is $1$ in $R$.
From this we conclude that each branch point has precisely one corresponding ramification point, and that there are precisely $2g+2$ ramification points.
Also, since there are no repeated roots in $f(x)$, then \eqref{equationdefiningequationpnot2} defines a non-singular affine curve $X'$ with a degree two projection $\pi'\colon X'\rightarrow \mathbb A_k^1$.
For any point $a\in \mathbb A_k^1$ which is not a solution to $f(x)$ there are two points in the pre-image, namely $(a,\pm \sqrt{a})$, and the point is not a branch point.
On the other hand, if $a = a_i \in \mathbb A_k^1$ is a solution to $f(x)$, then there is only one point in the pre-image and hence it is a branch point.
We let $P_i = P_{a_i}$ denote the ramification point corresponding to $a_i$.
Since $\deg(R) = 2g+2$ we conclude that if $d_f = 2g+1$ then $\infty \in \mathbb P_k^1$ is also a branch point and we define $P_{2g+2} := P_\infty$ in this case.
Hence the ramification divisor $R$ of $\pi$ is
    \[
    R = \sum_{i=1}^{2g+2} [P_i] .
    \]


In the following lemma we compute the divisor of $y \in K(X)$.
    \begin{lem}\label{lemmadivisorofycharacteristicnot2}
    The divisor of $y \in K(X)$ is 
        \begin{equation}\label{equationdivisorofypnot2}
        \di(y)  = R - (g+1)D_\infty.
        \end{equation}
    \end{lem}
    \begin{proof}
    Since $\di (y^2) = \di (f(x))$ and hence $\di(y) = \frac{1}{2}\di(f(x))$, we need only compute the divisor of $f(x)$.
    As noted earlier, the solutions to $f(x)$ correspond to the ramification points.
    So for any $P\notin x^{-1}(\infty)$ then $\ord_P(y) =  \frac{1}{2}\ord_P(f(x)) = 1$ if $P$ is a ramification point, and $\ord_P(y) = \frac{1}{2}\ord_P(f(x)) = 0$ otherwise.

    We now consider the poles of $y$.
    By Proposition \ref{propfinitelymanyzeroesandpoles} we know that $\sum_{P \in X} \ord_P(f(x)) = 0$, and we also know that the poles of $f(x)$ can only lie in $\pi^{-1}(\infty)$.
    Hence if $\infty$ is a branch point then $\ord_{P_\infty}(f(x)) = -\sum_{i=1}^{2g+1}\ord_{P_i}(f(x)) = -2(2g+1)$, and $\ord_{P_\infty}(y) = -(2g+1)$.
    On the other hand, if $\infty$ is not a branch point we know that $\ord_{P_\infty}(f(x)) + \ord_{P_\infty'}(f(x)) = -2(2g+2)$.
    Recall that $\ord_{P}(\sigma(f(x))) = \ord_{\sigma(P)}(f(x))$ for any automorphism $\sigma \in \aut(X)$ and any point $P \in X$.
    In particular, if $\sigma$ is the hyperelliptic involution of $X$ then 
        \[
        \ord_{P_\infty}(f(x)) = \ord_{P_\infty}(\sigma(f(x))) = \ord_{\sigma(P_\infty)}(f(x)) = \ord_{P_\infty'}(f(x)).
        \]
    Hence $\ord_{P_\infty}(y) = \ord_{P_\infty'}(y) = -(g+1)$
    Overall, we conclude that
        \[
        \di(y) = \sum_{i=1}^{2g+2} [P_i]- (g+1)D_\infty = R - (g+1)D_{\infty}.
        \]
    \end{proof}


    \begin{prop}\label{prophyperellipticbasispnot2}
    Let $m\geq 1$.
    Let $X$, $x$ and $y$ be as above, and let $\omega := \frac{dx^{\otimes m}}{y^m}$. 
    Then if $g\geq 2$, a basis of $H^0(X,\Omega_X^{\otimes m})$ is given by\par
        {\centering 
        \begin{tabular}{c c}
        $\omega, x\omega, \ldots , x^{g-1}\omega$ &  if $m=1$, \\
        $\omega, x\omega, x^2\omega$  &  if $m=g=2$, \\
        $\omega, x\omega, \ldots, x^{m(g-1)}\omega;\  y\omega, xy\omega, \ldots, x^{(m-1)(g-1)-2}y\omega$ &  otherwise.
        \end{tabular}\par
        }
    \end{prop}

    \begin{rem}
    Note that the case where $m=1$ is treated in \cite[Prop. 7.4.26]{liu} and \cite[Ch. IV, \S 4, Prop. 4.3]{griffiths}.
    \end{rem}

    \begin{proof}
    We first show that the elements are linearly independent over $k$.
    Since $\omega$ is fixed, it is equivalent to show that the coefficients are linearly independent over $k$ - \ie that $1,x,\ldots ,x^n, y, xy, \ldots, x^ly$ are linearly independent over $k$ for any $n$ and $l$ in $\NN$.
    It is immediate that $1, x, \ldots, x^n$ are linearly independent, and similarly that $y, yx, \ldots, yx^l$ are linearly independent.
    Finally, the two sets of elements are linearly independent of each other, otherwise the extension $K(X)/k(x)$ would be degree 1.

    To show that the differentials in the statement of the lemma are indeed holomorphic differentials, we show that their divisors are greater than $0$.
    Recall that $\di (dx^{\otimes m}) =m\di (dx)$, as noted in the previous chapter.
    We now show that the differentials listed in Proposition \ref{prophyperellipticbasispnot2} are holomorphic.
    We have that
        \begin{equation}\label{eqbasedifferentialdivisor}
        \begin{split}
        \di(x^i\omega) & =  \di \left( \frac{x^idx^{\otimes m}}{y^m} \right)\\ 
        & =  i(D_0 -D_\infty) + m(R-2D_\infty) -m(R-(g+1)D_\infty) \\
        & =  iD_0 + (mg -m -i)D_\infty \\
        & =  iD_0 + (m(g-1) -i)D_\infty,
        \end{split}
        \end{equation}
    by Lemma \ref{lemmadivisorofycharacteristicnot2}, \eqref{equationdivxpis2} and \eqref{equationdifferentialdivisor}, which is positive for $0\leq i \leq m(g-1)$.
    Hence all the polydifferentials in the first two cases and the first $m(g-1)+1$ differentials in the third case are holomorphic.
    Note that if $m=g=2$ then there are three elements, and since $\dim_kH^0(X,\Omega_X^{\otimes 2})=3$ by Corollary \ref{dim3}, these elements form a basis.
    Also, if $m=1$ then by Definition \ref{definitiongenus} $\dim_k H^0(X,\Omega_X)=g$, and we have $g$ linearly independent elements, so they again must form a basis.
    
    
    
    We now consider the final $(m-1)(g-1) - 1$ differentials in the third case.
    The divisor of one of these elements is
        \begin{align*}
        \di (x^iy\omega) & =  \di(x^i\omega) + R -(g+1)D_\infty \\
        & =  iD_0 + R +((m-1)(g-1)-2-i)D_\infty,
        \end{align*}
    by Lemma \ref{lemmadivisorofycharacteristicnot2} and \eqref{eqbasedifferentialdivisor}, which is positive for $0\leq i \leq (m-1)(g-1)-2$.
    By Corollary \ref{dim3} we know that 
        \[
        \dim_kH^0(X,\Omega_X^{\otimes m}) = (2m-1)(g-1).
        \]
    Since the number of differentials listed in the last case of the proposition is precisely
        \[
        (m-1)(g-1)-1 + m(g-1) +1 = 2mg -2m -g + 1 = (2m-1)(g-1),
        \]
    it is clear that these elements form a basis.
    \end{proof}


\section{Characteristic 2}

In this section we assume that $\cha(k) = p  =2$.   
In this case the function field $K(X)$ is $k(x,y)$, a degree two extension of the function field of one variable over $k$, $k(x) = k(\PP_k^1)$, where
    \begin{equation}\label{ext}
    y^2 - H(x)y = F(x)
    \end{equation}
for some polynomials $H(x), F(x)\in k[x]$, such that $H(x)$ and $H'(x)F(x) + F'(x)^2$ have no common roots in $k$ \cite[Prop.\ 7.4.24]{liu}.
We have that $\deg(H(x)) \leq g+1$, with equality if and only if $\infty$ is not a branch point, and that $\deg(F(x)) \leq 2g+2$ with $\deg(F(x)) = 2g+1$ if $\infty$ is a branch point  \cite[Prop.\ 7.4.24]{liu}.

    \begin{lem}\label{smoothness}
    The affine plane curve $X'$ given by \eqref{ext} is smooth if and only if $H(x)$ and $H'(x)^2 F(x) + F'(x)^2$ have no common zeroes in $k$.
    \end{lem}
    \begin{proof}
    The Jacobian criterion (see, for example, \cite[Thm. 4.2.19]{liu}), states that if the derivatives of \eqref{ext} with respect to $x$ and with respect to $y$ are zero at a point $P\in X'$ then the curve is not smooth at $P$, and otherwise it is.
    Clearly
        \begin{equation}\label{eqsmoothnessone}
        \frac{d}{dy} (y^2 -H(x)y -F(x)) = H(x)
        \end{equation}
    since the characteristic of $k$ is 2.
    On the other hand,
        \begin{equation}\label{eqsmoothnesstwo}
        \frac{d}{dx} (y^2 - H(x)y -F(x)) = H'(x)y - F'(x).
        \end{equation}
    The affine plane curve given by \eqref{ext} is smooth at $P\in X'$ if and only if at least one of \eqref{eqsmoothnessone} and \eqref{eqsmoothnesstwo} is non-zero at $P$.
    Of course, \eqref{eqsmoothnesstwo} is zero if and only its square
        \begin{equation}\label{eqsmoothnessthree}
        (H'(x)y-F'(x))^2 = H'(x)^2y^2 -F'(x)^2 = H'(x)^2H(x)y + H'(x)^2F(x) - F'(x)^2
        \end{equation}
    is zero.
    Finally, if $H(a) = 0$ for some $a \in k$, then \eqref{eqsmoothnessthree} evaluated at $a$ is $H'(a)^2F(a) - F'(a)^2$.
    Hence the curve is smooth if and only if $H'(x)^2F(x) - F'(x)^2$ and $H(x)$ share no roots in $k$.
    \end{proof}

We first describe the ramified points of $\pi$, in order to compute the ramification divisor.
By Lemma \ref{smoothness} if we consider the affine curve defined by this equation it will be smooth.
We denote this curve by $X'$.
Then $\pi$ restricts to a map $X'\rightarrow \mathbb A^1_k$, the projection on to the $x$ co-ordinate.
Let $a\in \mathbb A_k^1$.
Then if $(a,b)$ is a point in $\pi^{-1}(a)$, so is the point $(a,b+H(a))$, which is clearly distinct if and only if $H(a)\neq 0$.
Since the extension is degree two, this shows that the ramified points in the affine part correspond to the roots of $H(x)$.
We let $k$ be the number of distinct roots that $H(x)$ has and then 
    \begin{equation}\label{equationcapitalh}
    H(x) = \prod_{i=1}^{k} (x-A_i)^{n_i} = x^{d_H} + B_{{d_H}-1}x^{{d_H}-1} + \ldots + B_1x + B_0
    \end{equation}
for some $A_i, B_i \in  k$ and $n_i \in \mathbb N$.
As above, the $A_i$ are branch points of $\pi$ and we let $P_i \in X$ be the corresponding ramification points, and $D_i = D_{P_i}$.
Note that for each $A_i$ there is a corresponding $K_i$, which is the square root of $F(A_i)$.

We now compute the ramification divisor of $\pi$.


    \begin{lem}\label{char2ramification}
    Let $n_i$ be the order of $H(x)$ at $a_i\in \mathbb A_k^1$.
    Then the coefficient $\delta_P$ of the ramification divisor $R$ at $P\in X$ is given by
        \[
        \delta_P = \left\{
            \begin{array}{ll}
            2n_i & \text{if }\ P\in \{P_1,\ldots ,P_k\}, \\
            2(g+1-d_H) & \text{ if }\  P \in \pi^{-1}(\infty), \\
            0 & \text{ otherwise.} 
            \end{array}
        \right.
        \]
    \end{lem}
    \begin{proof}
    We first show that it will suffice to prove that the coefficient of $[P_i]$ is $2n_i$ for $1\leq i \leq k$.
    Note that by the Riemann-Hurwitz formula $\deg(R) = 2g+2$.
    If $\infty$ is not a branch point of $\pi$ then $\delta_P = 0 = 2(g+1-d_H)$, as stated.
    If $\infty$ is a branch point then the coefficient at $P_\infty$ is $\deg(R) - \sum_{i=1}^k2n_i = 2g+2-2d_H = 2(g+1-d_H)$, again as stated.
    
    Let $P=P_i$ for some $i\in \{1,\ldots , k\}$.
    Then $y-b_i$ is a local parameter at $P$.
    To see this, note that the maximal ideal $\mathfrak m_{P}$ of the local ring $\cO_{X,P}$ at $P$ is generated by $x-a_i$ and $y-b_i$.
    But $x-a_i\in \mathfrak m_{P}^2$ since $\pi$ is ramified at $P$ with ramification index 2.
    By Nakayama's lemma \cite[Prop. 2.6]{atiyahmacdonald}, $y-b_i$ is therefore a local parameter at $P$.
    \todo[inline]{change notations to capital a and check definition of $b_i$}
    
    Using Hilbert's formula, Theorem \ref{hilbertsformula}, we obtain
        \begin{align*}
        \delta_P & =  \sum_{i\geq 0} \left(\ord(G_i(P))-1\right) \\
        & =  \max\left\{ i\in \NN | G_i(P)\neq \{1\}\right\} + 1 \\
        & =  \ord_{P}(\sigma(y-b_i) - (y-b_i)).
        \end{align*}
    
    From the defining equation \eqref{ext}, it is clear that the hyperelliptic involution is given by $\sigma(y)=y+H(x)$.
    The following calculation then concludes the proof,
        \begin{align*}
        \delta_P & =  \ord_{P}(\sigma(y-b_i) - (y-b_i)) \\
        & =  \ord_{P}(y-b_i+H(x) - y + b_i) \\
        & =  2\ord_{a_i}(H(x)) \\
        & =  2n_i.\qedhere
        \end{align*}
    \end{proof}


The divisors of $x$ and $dx$ are the same as when $\cha(k) \neq 2$, see \eqref{equationdivxpis2} and \eqref{equationdifferentialdivisor}.
We also note that since $\cha(k) = 2$ we have
    \[
    dF(x) = d(y^2 + yH(x)) = d(yH(x)) = H(x)dy + ydH(x)
    \]
    and hence
    \begin{equation}\label{equationdivisorofdypis2}
    dy = \frac{F'(x) + yH'(x)}{H(x)}dx
    \end{equation}
We now compute the divisor of $H(x)$ too.



    \begin{lem}\label{h(x)char2}
    The divisor associated to $H(x)$ is
        \[
        \di (H(x)) = \sum_{i=1}^k n_i D_i - d_HD_\infty = R - (g+1)D_\infty.
        \]
    \end{lem}
    \begin{proof}
    If $\pi$ is ramified at infinity then $\ord_{P_{\infty}}(H(x)) = - 2d_H$.
    If it is not ramified, then $\ord_{P_{\infty}}(H(x)) = \ord_{P_{\infty}'}(H(x))=-d_H= -(g+1)$.
    For the ramified points $P_i$, $1\leq i \leq k$, then $ \ord_{P_i}(H(x))= 2n_i$.
    At any other point of $X$ the order of $H(x)$ is clearly zero, and the first equality follows.

    The second equality follows from Lemma \ref{char2ramification}.
    \end{proof}
    
Finally, we describe the divisor of $y$.
In order to do this we need to distinguish the zeroes of $F(x)$.
Suppose that $F(x)$ has $l \leq \deg(F(x))$ distinct zeroes, and let $\gamma_1, \ldots, \gamma_l \in k \subseteq \mathbb P_k^1$ be these zeroes.
Then if $\gamma_i$ is a branch point let $Q_i = (\gamma_i, 0)$ be the unique point in the pre-image $\pi^{-1}(\gamma_i)$.
If $\gamma_i$ is not a branch point then let $Q_i = (\gamma_i, 0)$ and $Q_i' = (\gamma_i, H(\gamma_i))$ be the unique points that form the pre-image $\pi^{-1}(\gamma_i)$.
Also, we denote the order of the zero of $F(x)$ at $\gamma_i \in k$ by $m_i \in \NN$.


    \begin{prop}\label{propdivisorofypis2}
    If $\infty$ is a branch point, the divisor of $y$ is
        \begin{equation*}
        \di(y) = 
         {\displaystyle \sum_{i=1}^l} m_i[Q_i] -(2g+1)[P_\infty].
        \end{equation*}
    If $\infty$ is not a branch point then, after possibly swapping the notations for the two points $P_\infty$ and $P_\infty'$ in $\pi^{-1}(\infty)$, we have
        \begin{equation*}
        \di(y) = {\displaystyle \sum_{i=1}^l} m_i[Q_i] +(g+1-\deg(F(x)))[P_\infty] - (g+1)[P_\infty'].
        \end{equation*}
    \end{prop}
    \begin{proof}
    We first show that the divisor of $y$ on the affine part of $X$, $U_\infty := X \backslash {\pi^{-1}(\infty)}$, is $\sum_{i=1}^l m_i [Q_i]$.
    Suppose $P\in U_\infty$.
    If $\left. F \right|_P \neq 0$ then it follows that $y|_P \neq 0$, since $F(x) = y (y + H(x))$ (and similarly $y$ does not have a pole at $P$).
    Hence $\di(y)$ has a coefficient  of zero for any point in $U_\infty\backslash \{Q_1, \ldots, Q_l \}$.
    
    Suppose that $P= Q_i = (\gamma_i, 0)$ is an unramified point in $U_\infty$.
    Then $H(\gamma_i) \neq 0$ and $\left. y \right|_P = 0$, so $y + H(x)$ is a unit at $P$.
    Since $y(y+H(x)) = F(x)$ we find that
        \begin{equation*}
        \ord_P(y) = \ord_P\left( \frac{F(x)}{y + H(x)} \right) = \ord_P(F(x)) = m_i.
        \end{equation*}
    
    We now look at when $P = Q_i = (\gamma_i, 0)$ is a ramification point.
    Since $H(x)$ and $H'(x)^2F(x) + F'(x)^2$ cannot share roots it follows that $m_i = 1$.
    Hence the function $\tilde F(x) := (x- \gamma_i)^{-1}F(x)$ is a unit at $P$.
    We let $\tilde H(x) = (x- \gamma_i)^{-1}H(x)$.
    
    
    Now 
        \[
        y^2 = F(x) - y H(x) = (x- \gamma_i) \left(\tilde F(x) - y \tilde H(x)\right),
        \]
    and hence
        \[
        \ord_P(y^2 ) = \ord_P(x-\gamma_i) + \ord_P(\tilde F(x) - y \tilde H(x)).
        \]
    Since $\ord_P(x-\gamma_i) = 2$ and $\ord_P\left(\tilde F(x) - y \tilde H(x)\right) \geq 0$ we know that $\ord_P(y) \geq 1$.
    Hence $(y \tilde H(x)) \big|_P = 0$, and since $\tilde F(x)$ is a unit at $P$, we conclude that $\tilde F(x) - y \tilde H(x)$ is a unit at $P$.
    Hence $\ord_P(y^2) = 2$, and so $\ord_P(y) = 1 = m_i$.
    It follows that the divisor of $y$ restricted to $U_\infty$ is $\sum_{i=1}^l m_i [Q_i]$.
    
    We now consider the coefficients in $\di(y)$ of the points in $\pi^{-1}(\infty)$.
    If $\infty$ is a branch point then $\deg(F(x)) = 2g+1$ and hence $\sum_{i=1}^l m_i = 2g+1$.
    Since $y$ can only have a pole at $P_\infty$, we conclude that the order of this pole is $2g+1$, and hence
        \[
        \di(y) = \sum_{i=1}^l m_i [Q_i] - (2g+1)[P_\infty].
        \]
    
    If $\infty$ is not a branch point then there are two points at which $y$ may have a pole, namely $P_\infty$ and $P_\infty'$.
    The hyperelliptic involution $\sigma$ switches these two points.
    Furthermore, since $\sigma \colon y \mapsto y+H(x)$ it follows that $\ord_{P_\infty'}(y) = \ord_{P_ \infty}(y+H(x))$, a fact we use below.
    
    
    We now consider three cases, firstly supposing that $\ord_{P_\infty}(y) < -(g+1)$.
    Then $\ord_{P_\infty}(y) < \ord_{P_\infty}(H(x))$ and hence $ \ord_{P_\infty}(y) = \ord_{P_\infty}(y+H(x))$.
    But this contradicts $\ord_{P_\infty}(y) + \ord_{P_\infty}(y+H(x)) = \ord_{P_\infty}(F(x))$, since the left hand side is less than $-2(g+1)$, which is the minimum value of the right hand side.
    
    We now suppose that $\ord_{P_\infty} (y) = -(g+1)$. Since $y(y+H(x)) = F(x)$ it follows that $-(g+1) + \ord_{P_\infty}(y+H(x)) = \ord_{P_\infty}(F(x))$, and hence $\ord_{P_\infty'}(y) = \ord_{P_\infty}(y+H(x)) = -\deg(F(x)) + g + 1$.
    
    We now consider the case in which $\ord_{P_\infty}(y) > -(g+1)$.
    Then, since $\ord_{P_\infty}(H(x)) = -(g+1)$, it follows that $\ord_{P_\infty'}(y) = \ord_{P_\infty} (y+H(x)) = -(g+1)$.
    It now follows from a computation similar to that in the previous paragraph that $\ord_{P_\infty}(y) = -\deg(F(x)) + g +1$, completing the proof.
    \end{proof}

The following proposition determines a basis of the $k$ vector space of global holomorphic polydifferentials.
The case where $m=1$ can again be found in \cite[Prop. 7.4.26]{liu}.
    
    \begin{prop}\label{propbasishyperellipticp=2}
    We assume that $g\geq 2$ and let $\omega:= \frac{dx^{\otimes m}}{H(x)^m}$. 
    Then if $g\geq 2$, a basis of $H^0(X,\Omega_X^{\otimes m})$ is given by\par
        {\centering
        \begin{tabular}{c c}
        $\omega, x\omega, \ldots , x^{g-1}\omega$ &  if $m=1$, \\
        $\omega, x\omega, x^2\omega$ & if $m=g=2$, \\
        $\omega, x\omega, \ldots, x^{m(g-1)}\omega;\  y\omega, xy\omega, \ldots, x^{(m-1)(g-1)-2}y\omega$ & otherwise.
        \end{tabular}\par
        }
    \end{prop}

    \begin{proof}
    We first assume that above elements are holomorphic polydifferentials, and show that they then form a basis.
    To show that the elements are linearly independent over $k$ we need only show that the coefficients of $\omega$ are, since $\omega$ is fixed.
    The only case where this is not clear is when the coefficients contain both $x$ and $y$ terms.
    But since the $y$ terms are all linear, and the extension is of degree two, it must follow that coefficients are linearly independent.
    
    
    In the case that $m=1$ then we have that $\dim_k H^0(X,\Omega_X) =g$ by Definition \ref{definitiongenus}, and there are $g$ elements described in the statement of the proposition in this case, so they must form a basis.
    If $m \geq 2$ then $\dim_k H^0(X,\Omega_X^{\otimes m}) = (2m-1)(g-1)$.
    If $m=g=2$ then $(2m-1)(g-1) = 3$, and there are three elements listed in the proposition.
    On the other hand if $m\geq 2$ and $g > 2$ the proposition lists
        \[
        m(g-1)+1 + (g-1)(m-1)-2+1 = 2mg -2m -g +1 = (2m-1)(g-1)
        \]
    elements, and again they must form a basis.
    
    We now show that the listed polydifferentials are holomorphic, \ie that their divisors are non-negative.
    Firstly we have
        \begin{align*}
        & \di(x^i\omega)  =  \di \left( \frac{x^i dx^{\otimes m}}{H(x)^m} \right)\\ 
        & =  i(D_0 - D_\infty) +m(R-2D_\infty) - m(R - (g+1)D_\infty) \\
        & =  iD_0 + (m(g-1) -i)D_\infty
        \end{align*}
    by \eqref{equationdivxpis2}, \eqref{equationdifferentialdivisor} and Lemma \ref{h(x)char2}, and this is clearly non-negative for $0\leq i \leq m(g-1)$.
    
    Similarly, if $\infty$ is a branch point, we have
        \begin{align*}
        \di(x^iy\omega) & =  \di (x^i\omega) + \di(y) \\
        & =  iD_0 + (m(g-1) -i)D_\infty + \sum_{i=1}^l m_i[Q_i] - (2g+1)[P_\infty] \\
        & =  iD_0 +  \sum_{i=1}^l m_i[Q_i] + (2m(g-1) -2g-1 -2i)[P_\infty] \\
        & =  iD_0 +  \sum_{i=1}^l m_i[Q_i] + (2((m-1)(g-1) -1 -i)-1)[P_\infty],
        \end{align*}
    by \eqref{equationdivxpis2}, \eqref{equationdifferentialdivisor} and Lemma \ref{h(x)char2} and Proposition \ref{propdivisorofypis2}, which is again clearly non-negative for $0 \leq i \leq (g-1)(m-1)-2$.

    Finally, if $\infty$ is not a branch then, after possibly switching $P_\infty$ and $P_\infty'$, we have
        \begin{align*}
        \di(x^iy\omega) &  = \di (x^i\omega) + \di(y) \\
        & \hspace{-3em} = iD_0 + (m(g-1)-1)D_\infty + {\displaystyle \sum_{i=1}^l} m_i[Q_i] + (g+1-\deg(F(x)))[P_\infty] - (g+1)[P_\infty'] \\
        & \hspace{-2em} - mR + m(g+1)D_\infty \\
        & \hspace{-3em} =  iD_0 + {\displaystyle \sum_{i=1}^l} m_i[Q_i] + (mg - i - m - g - 1)[P_\infty'] + (mg - i - m + g + 1 - \deg(F(x)))[P_\infty] \\
        & \hspace{-3em} =  iD_0 + {\displaystyle \sum_{i=1}^l} m_i[Q_i] + ((m-1)(g-1) - 2 - i)[P_\infty'] + (mg - i - m + g + 1 - \deg(F(x)))[P_\infty],
        \end{align*}
    by Proposition \ref{propdivisorofypis2}, \eqref{equationdivxpis2}, \eqref{equationdifferentialdivisor} and Lemma \ref{h(x)char2}.
    Since $0 \leq i \leq (g-1)(m-1)- 2$ then the coefficient of $[P_\infty']$ is clearly non-negative.
    Finally, since $\deg(F(x)) \leq 2g+2$, the coefficient of $[P_\infty]$ is greater than or equal to that of $[P_\infty']$, and we conclude that the above divisor is non-negative, completing the proof.
    \end{proof}






















