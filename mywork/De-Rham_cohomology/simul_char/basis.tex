% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
% \geometry{landscape} % set up the page for landscape
% read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options
\usepackage[obeyDraft]{todonotes}

%\usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{mathtools}
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
%\usepackage{hyperref}
% These packages are all incorporated in the memoir class to one degree or another...

%\usepackage[activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=1100,stretch=10,shrink=10]{microtype}
%\microtypecontext{spacing=nonfrench}
% activate={true,nocompatibility} - activate protrusion and expansion
% final - enable microtype; use "draft" to disable
% tracking=true, kerning=true, spacing=true - activate these techniques
% factor=1100 - add 10% to the protrusion amount (default is 1000)
% stretch=10, shrink=10 - reduce stretchability/shrinkability (default is 20/20)

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsopn}
\usepackage{amssymb}
%\usepackage{natbib}
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
%\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
%\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!
%\renewcommand{\familydefault}{\sfdefault}
%\usepackage{cabin}
%\usepackage{libertine}
%\usepackage[T1]{fontenc}

%Theorems and stuff
\theoremstyle{plain}
\newtheorem{defn}{Definition}[section]
\newtheorem{thm}[defn]{Theorem}
\newtheorem{cor}[defn]{Corollary}
\newtheorem{lem}[defn]{Lemma}
\newtheorem{prop}[defn]{Proposition}
\newtheorem{ex}[defn]{Example}
\newtheorem*{unnumthm}{Theorem}
\newtheorem{defnlem}[defn]{Definition/Lemma}
\newtheorem{defnthm}[defn]{Theorem/Definition}
\theoremstyle{remark}
\newtheorem*{rem}{Remark}
\newtheorem*{note}{Note}


\newcommand{\cO}{{\cal O}}
\newcommand{\ra}{\rightarrow}
\newcommand{\NN}{{\mathbb N}}
\newcommand{\PP}{{\mathbb P}}
\newcommand{\ZZ}{{\mathbb Z}}
\newcommand{\cL}{{\mathcal L}}
\newcommand{\cA}{{\mathcal A}}
\newcommand{\cD}{{\mathcal D}}
\newcommand{\cU}{{\mathcal U}}
\newcommand{\cech}{\v{C}ech }
\newcommand{\hzero}{{H^0(X,\Omega_X)}}
\newcommand{\hone}{H^1(X,\mathcal{O}_X)}
\newcommand{\cechhone}{\check{H}^1(\mathcal U,\mathcal O_X)}
\newcommand{\derhamhone}{H_{\text {dR}}^1(X/k)}
\newcommand{\cechhzero}{{\check{H}^0(X,\Omega_X)}}


\DeclareMathOperator{\aut}{Aut}
\DeclareMathOperator{\res}{Res}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\di}{div}
\DeclareMathOperator{\cha}{char}
\DeclareMathOperator{\gal}{Gal}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Ima}{Im}

%%% END Article customizations

%%% The "real" document content comes below...

\title{Group actions on de Rham cohomology of hyperelliptic curves}
\author{}
%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed

\begin{document}
\maketitle

\listoftodos

\section{Background}

\todo[inline]{consider consistency of putting differential in frac or not}
\todo[inline]{change references to preprint when in thesis}

Let $X$ be a smooth, projective, connected hyperelliptic curve of genus $g \geq 2$ over an algebraically closed field $k$ of characteristic $p \geq 0$.
We  fix a map $\pi \colon X \rightarrow \mathbb P_k^1$ of degree two, which is unique up to an automorphism of $\mathbb P_k^1$.
We also suppose that we have a finite group $G$ acting faithfully on $X$.

In a similar vein to \cite{canonicalrepresentation}, we will be using \cech cohomology to compute both $\hone$ and the de Rham hypercohomology, denoted $\derhamhone$.
We therefore recall the \cech cohomology relevant to both of these, starting with $\hone$.

By Leray's theorem \cite[Thm 5.2.12]{liu} and Serre's affineness criterion \cite[Thm 5.2.23]{liu} we know that the first \cech cohomology group and $\hone$ will be isomorphic if the cover we use to compute the \cech cohomology is affine.
In general we let $U_a = X \backslash \pi^{-1}(a)$ for any $a \in \mathbb P_k^1$ and we let ${\cal U} = \{ U_0, U_\infty\}$.
Given any sheaf $\cal F$ on $X$ we have a canonical map $\check{d}\colon {\cal F}(U_0) \times {\cal F} (U_\infty) \rightarrow {\cal F}(U_0 \cap U_\infty)$, defined by $(f_0,f_\infty) \mapsto f_0|_{U_0 \cap U_\infty} - f_\infty|_{U_0 \cap U_\infty}$.
In general we will suppress the notation denoting the restriction map.
Via this differential we have the following cochain complex
\begin{equation*}
0 \rightarrow \cO_X(U_0)\times \cO_X(U_\infty) \xrightarrow{\check{d}} \cO_X(U_0 \cap U_\infty) \rightarrow 0.
\end{equation*}
The first cohomology group of this chain is $\cechhone = \frac{\cO_X(U_0 \cap U_\infty)}{\Ima(\check{d})}$ and hence
\begin{equation}\label{cechhone}
\hone \cong \frac{\cO_X(U_0 \cap U_\infty)}{\Ima(\check{d})}  
 = \frac{\cO_X(U_0 \cap U_\infty)}{\{f_0 - f_\infty | f_i \in \cO_X(U_i) \}}.
\end{equation}

We now recall how to compute the algebraic de Rham cohomology of $X$ via \cech cohomology.
We now consider the de Rham cohomology of $X$, which is the hypercohomology of the de Rham complex of $X$.
Since a curve doesn't have differentials of degree greater than one, this is the hypercohomology of the complex
\begin{equation}\label{res}
0 \rightarrow \cO_X \xrightarrow{d} \Omega_X \rightarrow 0.
\end{equation}
Here $d$ denotes the differential map $f \mapsto df$.\todo{cite}

We then use the cover $\cal U$ and the \cech differentials as defined earlier to give us the \cech complex of \eqref{res}, which is
\begin{equation}\label{bicomplex} \begin{array}{ccccccc}
~ & ~ & 0 & ~ & 0 & ~ & ~ \\
~ & ~ & \downarrow & ~ & \downarrow & ~ & ~ \\
0 & \rightarrow & \cO_X(U_0)\times \cO_X(U_\infty) & \rightarrow & \Omega_X(U_0)\times \Omega_X(U_\infty) & \rightarrow & 0 \\
~ & ~ & \downarrow & ~ & \downarrow & ~ & ~ \\
0 & \rightarrow & \cO_X(U_0 \cap U_\infty) & \rightarrow & \Omega_X(U_0 \cap U_\infty) & \rightarrow & 0 \\
~ & ~ & \downarrow & ~ & \downarrow & ~ & ~ \\
~ & ~ & 0 & ~ & 0 & ~ & ~ \\
\end{array}
\end{equation}
By a generalisation of Leray's theorem \cite[Cor 12.4.7]{EGA0III} we know that the $\derhamhone$ is isomorphic to the first cohomology of the total complex of \eqref{bicomplex}.
Note that this requires ${\check H}^p(U_\sigma, \cO_X)$ and ${\check H}^p(U_\sigma, \Omega_X)$ to be zero for any $\sigma$ in the nerve of $\cU$ and any $p \geq 1$ ---
since $U_0$ and $U_\infty$ are affine, this again follows from Serre's affineness criterion \cite[Thm 5.2.23]{liu}.



After computing the first cohomology group of the total complex of \eqref{bicomplex} we see that $\derhamhone$ is isomorphic to the space
\begin{equation}\label{derhamconditions}
\left\{(\omega_0, \omega_\infty, f_{0,\infty}) | \omega_i\in \Omega_{X/k}(U_i), f_{0,\infty}\in \cO_X(U_0 \cap U_\infty), df_{0,\infty} = \omega_0|_{U_0\cap U_\infty} - \omega_\infty|_{U_0\cap U_\infty} \right\}
\end{equation}
quotiented by the subspace
\begin{equation}\label{quotient}
\left\{  (df_0, df_\infty, f_0|_{U_0\cap U_\infty} -f_\infty|_{U_0\cap U_\infty} )|f_i \in \cO_X(U_i)\right\}.
\end{equation}

We wish to compute a $k$-basis of $\derhamhone$ in order that we can see how $G$ acts on $\derhamhone$ and to study the $k[G]$-module structure.
To do this we will compute $k$-bases for the two outer terms of the short exact sequence
\begin{equation}\label{ses}
0 \ra H^0(X,\Omega_X) \ra \derhamhone \ra H^1(X,\cO_X) \ra 0.
\end{equation}
\todo[inline]{make this in to a lemma?}
A basis of $H^0(X,\Omega_X)$ is already available in the literature (see, for example, \cite[Prop. 7.4.26]{liu}) so we need only compute a basis of $H^1(X,\cO_X)$, which we do in the next section.

Before the next section we briefly discuss the exact sequence \eqref{ses}.
Firstly, $\cechhzero \cong \hzero$ is the kernel of
\[
0 \ra \Omega_X(U_0) \times \Omega_X(U_\infty) \ra \Omega_X(U_0 \cap U_\infty ) \ra 0,
\]
i.e. elements of the form $(\omega, \omega)$.
Hence we can define an injection $\hzero \ra \derhamhone$ given by\todo{justify why an injection}
\[
(\omega, \omega) \mapsto (\omega, \omega, 0).
\]
\todo[inline]{change the above to just $\omega$, not $(\omega,\omega)$}
On the other hand, we have an obvious surjection $\derhamhone \ra \hone$ induced by\todo{justify why a surjection}
\[
(\omega_0, \omega_\infty, f_{0, \infty}) \mapsto f_{0, \infty}.
\]
We now check that these maps make \eqref{ses} in to an exact sequence.
If $(\omega_0, \omega_\infty, f_{0,\infty})$ is in the kernel of $\derhamhone \ra \hone$ then there exist $f_0 \in \cO_X(U_0)$ and $f_\infty \in \cO_X(U_\infty)$ such that $f_{0,\infty} = f_0 - f_\infty$.
Then 
\begin{align*}
(\omega_0 , \omega_\infty, f_{0, \infty}) & =  (\omega_0 , \omega_\infty, f_{0, \infty}) - (df_0, df_\infty, f_{0, \infty}) \\
& = (\omega_0 - df_0, \omega_\infty - df_\infty, 0)
\end{align*}
where the first equality follows from \eqref{quotient}.
By \eqref{derhamconditions} we know that $(\omega_0 - df_0)  - (\omega_\infty - df_\infty) = d0 = 0$ on $U_0 \cap U_\infty$,  and hence $(\omega_0, \omega_\infty, f_{0, \infty})$ is in the image of $\hzero \ra \derhamhone$.


\section{Basis of $\derhamhone$}

The bases of the $k$-vector spaces in \eqref{ses} will be given in terms of defining equations of the hyperelliptic curve $X$, so we describe these now.
Throughout we will denote by $P_a$ and $P_a'$ the unique elements of $\pi^{-1}(a)$ for any point $a \in \mathbb P_k^1$ that is not a branch point.
If $a \in \mathbb P_k^1$ is a branch point we denote the unique point in $\pi^{-1}(a)$ by $P_a$.
We also define $D_a$ to be the divisor $\pi*([a])$ for any $a \in \mathbb P_k^1$, and hence
\begin{equation}\label{divisorofpoints}
D_a= 
\begin{cases}
 2[P_a] & \text{if $a$ is a branch point} \\
 [P_a] + [P_a'] & \text{otherwise,}
\end{cases}
\end{equation}
With this notation we clearly have
\begin{equation}\label{divxp=2}
\di (x)  = D_0 - D_\infty
\end{equation}
regardless of the characteristic of $k$.
Also, as in \cite[\S 6]{faithfulaction}, we have
\[
\di(dx) = R - 2D_\infty,
\]
again regardless of characteristic.

If $p \neq 2$ then the extension $K(X)$ of $K(\mathbb P_k^1) = k(x)$ will be $k(x,y)$ where $y$ satisfies
\begin{equation}\label{definingequationpnot2}
y^2 = f(x)
\end{equation}
for some polynomial $f(x) \in k[x]$, of degree $2g+1$ or $2g+2$ \cite[Prop 7.4.24]{liu}.

We let $R$ be the ramification divisor of $\pi$, and recall from \cite[\S 6]{faithfulaction} that
\begin{equation}\label{pnot2divisors}
\di(y)  = R - (g+1)D_\infty.
\end{equation}


If $p=2$, then the extension $K(X)$ of $k(x)$ will be $k(x,y)$, this time with $y$ satisfying the equation
\begin{equation}\label{definep=2}
y^2 - H(x)y = F(x),
\end{equation}
for some $H(x),F(x) \in k[x]$, such that $H(x)$ and $H'(x)^2F(x) + F'(x)^2$ share no roots.
We require that $\deg(H(x)) \leq g+1$, with equality if and only $\infty$ is not a branch point, and that $\deg(F(x)) \leq 2g+2$ with $\deg(F(x)) = 2g+1$ if $\infty$ is a branch point  \cite[Prop 7.4.24]{liu}.


We now recall the divisor of $H(x)$ from \cite[\S 6]{faithfulaction}:
\begin{equation}
\di (H(x))  = R - (g+1)D_\infty. \label{divhp=2}
\end{equation}
Finally, we also make use of the divisor of $y$. 
In order to describe this we need to distinguish the zeroes of $F(x)$.
Suppose that $F(x)$ has $l \leq \deg(F)$ distinct zeroes, and let $\gamma_1, \ldots, \gamma_l \in k \subseteq \mathbb P_k^1$ be these zeroes.
Then if $\gamma_i$ is a branch point let $Q_i = (\gamma_i, 0)$ be the unique point in the pre-image $\pi^{-1}(\gamma_i)$.
If $\gamma_i$ is not a branch point then let $Q_i = (\gamma_i, 0)$ and $Q_i' = (\gamma_i, H(\gamma_i))$ be the unique points that form the pre-image $\pi^{-1}(\gamma_i)$.
Also, we denote the order of the zero of $F(x)$ at $\gamma_i \in k$ by $m_i$.


\begin{prop}
Suppose that $p=2$.
Then, without loss of generality, the divisor of $y$ is
\begin{equation}\label{divyp=2}
\di(y) = \begin{cases}
 \sum_{i=1}^l m_i[Q_i] -(2g+1)[P_\infty] & \text{if $\infty$ is a branch point,} \\
 \sum_{i=1}^l m_i[Q_i] +(g+1-\deg(F(x)))[P_\infty] - (g+1)[P_\infty'] & \text{otherwise.}
\end{cases}
\end{equation}
\end{prop}
\begin{proof}
We first show that the divisor of the zeroes of $y$ is $\sum_{i=1}^l m_i [Q_i]$, regardless of whether $\infty \in \mathbb P_k^1$ is a branch point.

It is clear that the zeroes of $y$ must occur in the affine part of the curve $X$ defined by \eqref{definep=2} i.e. in $U_\infty$.
Suppose $P\in U_\infty$.
If $\left. F \right|_P \neq 0$ then it follows that $y \neq 0$, since $F(x) = y (y + H(x))$.
Hence $\di_0(y)$ has zero coefficients for any point in $U_\infty$ other than the $Q_i$.\todo{check that $\di_0$ is defined}

So now we suppose that $P= Q_i = (\gamma_i, 0)$ is an unramified point in $U_\infty$.
Then $H(\gamma_i) \neq 0$ and $\left. y \right|_P = 0$, so $y + H(x)$ is a unit at $P$.
Since $y(y+H(x)) = F(x)$ we find that
\begin{equation}\label{unramifiedcoefficient}
\ord_P(y) = \ord_P\left( \frac{F(x)}{y + H(x)} \right) = \ord_P(F(x)) = m_i.
\end{equation}

We now look at when $P = Q_i = (\gamma_i, 0)$ is a ramification point.
Since $H(x)$ and $H'(x)^2F(x) + F'(x)^2$ cannot share roots, we see that $P$ being a ramification point implies $m_i = 1$.
Hence we let $\tilde F(x) = \frac{F(x)}{x- \gamma_i}$, which is a unit at $P$.
We also let $\tilde H(x) = \frac{H(x)}{x- \gamma_i}$.
Now $y^2 = F(x) - y H(x) = (x- \gamma_i) (\tilde F(x) - y \tilde H(x))$, and hence
\[
\ord_P(y^2 ) = \ord_P(x-\gamma_i) + \ord_P(\tilde F(x) - y \tilde H(x)).
\]
Since $\ord_P(x-\gamma_i) = 2$ and $\ord_P(\tilde F(x) - y \tilde H(x)) \geq$ we know that $\ord_P(y) \geq 1$.
Hence $\left. (y \tilde H(x)) \right|_P = 0$, and since $\tilde F(x)$ is a unit at $P$, we conclude that $\tilde F(x) - y \tilde H(x)$ is a unit at $P$.
Hence we see that $\ord_P(y^2) = 2$, and so $\ord_P(y) = 1 = m_i$.
So we see that the divisor of zeroes of $y$ is precisely $\sum_{i=1}^l m_i [Q_i]$.

We now consider the poles of $y$.
Clearly if $\infty$ is a branch point we know that $\deg(F(x)) = 2g+1$ and hence $\sum_{i=1}^l m_i = 2g+1$.
Since $y$ can only have a pole at $P_\infty$, we conclude that the degree of this pole is $2g+1$, and hence
\[
\di(y) = \sum_{i=1}^l m_i [Q_i] - (2g+1)[P_\infty]
\]
when $\infty$ is a branch point.

If $\infty$ is a branch point then there are two points at which $y$ may have a pole, namely $P_\infty$ and $P_\infty'$.
We consider three cases, and remind the reader that $\ord_{P_\infty}(y + H(x)) = \ord_{P_\infty'}(y)$, using the automorphism given by $y \mapsto y+H(x)$.
Firstly, we suppose that $\ord_{P_\infty}(y) < -(g+1) < -g = \ord_{P_\infty}(H(x))$.
Then $ \ord_{P_\infty}(y) = \ord_{P_\infty}(y+H(x))$.
But this contradicts $\ord_{P_\infty}(y) + \ord_{P_\infty}(y+H(x)) = \ord_{P_\infty}(F(x))$, since the left hand side is less than $-2(g+1)$, which is the minimum value of the right hand side.

On the other hand, if $\ord_{P_\infty} (y) = -(g+1)$, we see that since $y(y+H(x)) = F(x)$ it follows that $-(g+1) + \ord_{P_\infty}(y+H(x)) = \ord_{P_\infty}(F(x))$, and hence $\ord_{P_\infty}(y+H(x)) = -\deg(F(x)) + g + 1$.

Finally, if $\ord_{P_\infty}(y) > -(g+1)$, then since $\ord_{P_\infty}(H(x)) = -(g+1)$ it follows that $\ord_{P_\infty} (y+H(x)) = -(g+1)$.
Then, from a similar computation to that in the previous paragraph we see that $\ord_{P_\infty}(y) = -\deg(F(x)) + g +1$, completing the proof.
\end{proof}



Finally, we will compute the divisor of $dy$.
We start by noting that when we take the differential of \eqref{definep=2} we obtain
\[
dF = d\left(y^2 + yH \right) = d(yH) = Hdy + ydH
\]
and from this follows 
\begin{equation}\label{divdyp=2}
dy = \frac{F'-yH'}{H}dx.
\end{equation}


To state the ramification points, and for later use, we suppose that 
\begin{equation}\label{hcoefficients}
H(x) = \prod_{i=1}^d (x-a_i)^{n_i} = x^d + b_{d-1}x^{d-1} + \ldots + b_1x
\end{equation}
for some $a_i, b_i \in  k$, $d \leq g+1$ and $n_i \in \mathbb N$.
Then the $a_i \in \mathbb A_k^1 \subset \mathbb P_k^1$ are the branch points of $\pi$ and we let $P_i \in X$ be the corresponding ramification points above $a_i$.
Given this, we can write the ramification divisor as
\[
R = \sum_{i=1}^d 2n_i[P_i] + (g+1-d)D_\infty.
\]
Details can be found in \cite[\S 6]{faithfulaction}.

We now recall some facts regarding Serre duality, which we will use shortly to find a basis of $\hone$.
We recall \todo{cite when in thesis. Will change $r$ notation then.} that an {\sl ad\`ele} or {\sl r\'epartition} is a collection $\{r_P\}_{P\in X}$ of elements of $K(X)$ such that $r_P \in \cO_P$ for almost all $P\in X$, as in \cite[Chap. II, \S 5]{algebraicgroupsandclassfields}.
We let $A$ denote the space of ad\`eles, and given a divisor $D = \sum n_P[P]$ we let $A(D)$ be the space of ad\`eles $r = \{r_P\}$ such that $\ord_P(r_P) \geq -n_P$ for all $P \in X$.
Note that one can embed the function field $K(X)$ into $A$.
Given any $f \in K(X)$ one defines $r \in A$ by setting $r_P = f$ for all $P \in X$, and this is clearly an injection.
Given this we can see that the quotient $A/(A(0) + K(X))$ is well defined, and Serre shows in \cite[Prop. 3, Chap II]{algebraicgroupsandclassfields} that $\hone$ is isomorphic to this quotient.
Note that we can extend this embedding to $\cO_X(U)$ for any open set $U \subseteq X$.
Suppose that $\left. f \right|_U\in cO_X(U)$ and then let $r_P = f$ if $P \in U$, and $r_P = 1$ otherwise.

We now define the duality map in terms of ad\`eles.
Given some differential $\omega \in \hzero$ and some ad\`ele $r \in \hone$ we define 
\begin{equation}\label{residuemap}
\langle \omega, r \rangle := \sum_{P\in X} \res_{P}( r_P\omega).
\end{equation}
Then if we fix any $\omega \in \hzero$ we get a map $\theta(\omega):\hone \rightarrow k$ given by $\theta(\omega)(r) = \langle \omega, r \rangle$.
Similarly, if we fix some $r \in \hone$ we get a map $\varphi(r):\hzero \rightarrow k$.
The duality theorem \cite[Thm. 2, Chap. II]{algebraicgroupsandclassfields} states that the maps $\theta$ and $\varphi$ are isomorphisms meaning that the spaces $\hzero$ and $\hone$ are dual.

\todo[inline]{using repartitions, it may be better to say that the restriction to U1 is like taking a repartition equal to f everywhere except P0, where we just pick some non-zero value}

We now compute a basis of $H^1(X,\cO_X)$, and then state a basis of $\derhamhone$ in the following theorem.
\begin{lem}\label{basish1}
 Via the isomorphism \eqref{cechhone} the residue classes of $\frac{y}{x}, \ldots , \frac{y}{x^g} \in K(X)$, restricted to $U_0$\todo{should this be $U_0 \cap U_\infty$}, form a basis of $H^1(X,\cO_X)$.\todo{check over this letter}
\end{lem}
\begin{proof}
We start by considering the case $p \neq 2$ and first check that the functions are indeed regular on $U_0 \cap U_\infty$ (as required by \eqref{derhamconditions}) by computing their divisors:
\begin{align*}
\di \left( \frac{y}{x^i} \right) & = \di (y) - \di ( x^i) \\
& = R - (g+1)D_\infty - iD_0 + iD_\infty \\
& = R - iD_0 - (g+1 - i)D_\infty, 
\end{align*}
Since $R$ is a positive divisor this is clearly positive on $U_0 \cap U_\infty$.


We use Serre duality and the fact that for $i= 0, \ldots, g-1$ the elements $\omega_i = x^iy^{-1}dx$ form a basis of $\hzero$.
As we saw above, we can embed elements of $K(X)$ and their restrictions in to $A$, the space of ad\`eles.
Using this we can consider $yx^{-i}|_{U_0}$ as an ad\`ele and hence consider $\langle x^iy^{-1}dx, yx^{-j}|_{U_0}\rangle = \sum_{P\in U_0} \res_{P} (x^{i-j}dx)$ for $j \in \{1, \ldots, g\}$. 
We see from \eqref{divxp=2} and \eqref{pnot2divisors} that the divisor of $x^{i-j}dx$ when $p\neq 2$ is
\begin{equation}\label{residuedivisor}
\begin{split}
\di(x^{i-j}dx) & = R - 2D_\infty +(i-j)D_0 - (i-j)D_\infty \\
& = R + (i-j)D_0 - (i-j+2)D_\infty.
\end{split}
\end{equation}
Now if $\infty$ is a branch point, then we see that $x^{i-j}dx$ has a pole of order one at $P_\infty$ if and only if $i-j = -1$ (recall that in this case the ramification divisor has a $[P_\infty]$ term with coefficient one) and hence $\res_{P_\infty}(\left(x^{-1}dx\right) \neq 0$.
Since the differential has no other poles on $U_0$ it follows that $\sum_{P \in U_0} \res_P(x^{-1}dx)  \neq 0$.
As described in the paragraph preceding this lemma, the scalar product $ \langle , \rangle \colon \hzero \times \hone \ra k$ puts $\hzero$ and $\hone$ dual to each other.
We have shown that for $i \in \{0, \ldots, g-1\}$ the product $\langle x^iy^{-1}dx, yx^{-(i+1)}|_{U_0} \rangle \neq 0$.
Hence the elements $\frac{y}{x^j}$ form a (dual) basis for $j \in \{1, \ldots , g\}$.


On the other hand, if $\infty$ is not a branch point then we see from \eqref{residuedivisor} that we still have order one poles at both $P_\infty$ and $P_\infty'$ if and only if $i-j=-1$.
In this case we see that there are still no poles in $U_0\backslash \pi^{-1}(\infty)$ and hence $\sum_{P \in U_0}\res_P(x^{-1}dx) = \res_{P_\infty}(x^{-1}dx) + \res_{P_\infty'}(x^{-1}dx)$.
As we assumed $p\neq 2$ it is sufficient to show that $\res_{P_\infty}(x^{-1}dx) = \res_{P_\infty'}(x^{-1}dx)$ in order to prove that $\langle x^iy^{-1}dx, yx^{-(i+1)}|_{U_0} \rangle \neq 0$.

We can show this using the hyperelliptic involution $\sigma$.
Suppose we have an isomorphism of curves $\phi\colon W \ra V$ and we consider some differential $\omega$ on $V$.
Then if we fix a point $P \in W$ it follows that
\[
\res_P(\phi^*(\omega)) = \res_P(\omega \circ \phi) = \res_{\phi(P)}(\omega).
\]
In particular, if we consider the differential $x^{-1}dx$ and the isomorphism $\sigma\colon X \ra X$, then we see that $\res_{P_\infty} (x^{-1}dx) = \res_{P_\infty'}(x^{-1}dx)$.
Hence $\langle x^iy^{-1}dx, \left. yx^{-(i+1)}\right|_{U_0} \rangle \neq 0$ and so for $1 \leq j \leq g$ the elements $\frac{y}{x^j}$  form a basis dual to $\frac{x^i}{y}dx$ for $0 \leq i \leq g-1$.

\begin{comment}
On the other hand, if $\infty$ is not a branch point we have two poles of order one, $P_\infty$ and $P_\infty'$.
Since we have two poles we need to check that the residues at these poles do not cancel to zero.
This is equivalent to checking that the residue is non-zero at the points in $X\backslash U_0$ (of which there are at most two --- $P_0$ and $P_0'$).
If $0$ is a branch point then we have a pole at $P_0$ of order one when $i-j=-1$, and hence a non-zero residue, and we are done.
On the other hand if $0$ is not a branch point then when $i-j=-1$ we have a pole at both of these, so we need to check that the residues do not cancel.
Fortunately, they are largely symmetric.
We note that $t=y-\sqrt{f(0)}$ and $s=y+\sqrt{f(0)}$ are uniformising parameters at $P_0$ and $P_0'$ respectively.
We also note that since
\[
2ydy = dy^2 = df = f'dx
\]
then
\[
dy=\frac{f'}{2y}dx.
\]
We then rewrite the expansion of $\frac{1}{x}dx$ (i.e. $x^{i-j}dx$ when $i-j=-1$) as follows
\begin{align*}
\frac{1}{x}dx & = \sum_{i\geq -1}c_it^i dt \\
& = \sum_{i\geq -1}c_it^i d\left(y-\sqrt{f(0)}\right)\\
& = \sum_{i\geq -1}c_it^i dy \\
& = \sum_{i\geq -1}c_it^i \frac{f'}{2y}dx,
\end{align*}
where $c_i \in k$.
Now that both sides are in terms of the same differential we can match coefficients to discover the value of $c_{-1}$.
We remark that at this point the exact same computations yield
\[
\frac{1}{x}dx = \sum_{i\geq -1}d_is^i \frac{f'}{2y}dx.
\]
Now $\frac{1}{x}$ has a pole at $P_0$ and the coefficient of $dx$ on the right hand side that can also have a pole at $P_0$ is 
\[
c_{-1}t^{-1}\frac{f'}{2y} = \frac{c_{-1}f'}{2y^2 - 2y\sqrt{(f(0)}} = \frac{c_{-1}f'\left( 2f+2y\sqrt{f(0)}\right) }{4(f^2-f\cdot f(0))}.
\]
We will use the fact that this is the only part of the sum that can contain a term of the form $\frac{1}{x}$ to compute the residue.
Clearly no part of $\frac{2c_{-1}f'y\sqrt{f(0)}}{4(f^2-f\cdot f(0))}$ can contain a $\frac{1}{x}$ term, since there is no way of removing the $y$.
This means we just need to compute the $\frac{1}{x}$ terms in $\frac{c_{-1}f'\cdot f}{2(f^2-f\cdot f(0))}$ and compare coefficients to show the residue is non-zero on $X \backslash U_0$.

We notice at this point that by almost the same calculations when expanding about $P_0'$ we get the following
\[
d_{-1}s^{-1}\frac{f'}{2y} = \frac{d_{-1}f'\left(2f-2y\sqrt{f(0)}\right) }{4(f^2 - f\cdot f(0))}.
\]
Using the same argument as before we dispense of the $y$ term, and hence $d_{-1}$ is determined uniquely by the $\frac{1}{x}$ terms in $\frac{2d_{-1}f' \cdot f}{4(f^2-f\cdot f(0))}$.
Since $c_{-1}$ and $d_{-1}$ are determined in the same way, they must take the same value. 
Since the characteristic is not 2, and since $c_{-1} \neq 0$, we conclude that $\res_{X\backslash U_\infty}(x^{-1}dx) = 2c_{-1} \neq 0$.
This completes the proof when $p \neq 2$.
\end{comment}

We now suppose that $p=2$, and again start by checking that for $i \in \{1, \ldots , g\}$ the function $\frac{y}{x^i}$ is regular on $U_0 \cap U_\infty$ by computing the divisor
\begin{equation*}
\di \left( \frac{y}{x^i} \right)  =  \begin{cases}
\di_0(y) -iD_0 -(2g+1 - 2i)[P_\infty] \\
 \di_0(y) - iD_0 +(g+1-\deg(F(x) + i))[P_\infty] - (g+1-i)[P_\infty'].
\end{cases}
\end{equation*}
Note that this makes use of \eqref{divyp=2} and \eqref{divxp=2}, and is clearly positive on $U_0 \cap U_\infty$.

Next we recall from \cite{faithfulaction} that in this case a basis of $\hone$ is given by $\frac{x^i dx}{H(x)}$.
We then compute the divisor of $\left( \frac{y}{x^j} \cdot \frac{x^i dx}{H(x)}\right)$, which is
\begin{align*}
\di\left( \frac{yx^{i-j}dx}{H(x)} \right) & = \di(y) + \di(x^{i-j}) + \di( dx) - \di(H(x)) \\
& = \di_0(y) - (2g+ 1 )[P_\infty] + (i-j)D_0 - (i-j)D_\infty + R - 2D_\infty \\
& \qquad - R + (g+1)D_\infty\\
& = \di_0(y) + (2j-3-2i)[P_\infty] + (i-j)D_0
\end{align*}
when $P_\infty$ is a ramification point.
So we see that there is a pole of order one at $P_\infty$ if $2j - 3 - 2i = -1$, or equivalently if $j = i+1$.
Since $i$ ranges from $0$ to $g-1$ we see that for $1\leq j \leq g$ the elements $\frac{y}{x^j}$ form a basis of $\hone$.

If $\infty \in \mathbb P_k^1$ is not a branch point then we see that the divisor of $\frac{y}{x^j} \cdot \frac{x^i dx}{H(x)}$ is
\begin{align*}
\di\left( \frac{yx^{i-j}dx}{H(x)} \right) & = \di(y) + \di(x^{i-j}) + \di( dx) - \di(H(x)) \\
& = \di_0(y) + (g+1-\deg(F(x)))[P_\infty] - (g+1)[P_\infty'] + (i-j)D_0 \\
& \qquad - (i-j)D_\infty + R - 2D_\infty - R + (g+1)D_\infty \\
& = \di_0(y) + (j+g-i-\deg(F(x)))[P_\infty] + (j - i -2)[P_\infty'] + (i-j)D_0.
\end{align*}
Clearly if $j=i+1$ we have a pole of order one at $P_\infty'$.
Moreover, if this is the case and $g+(j-i) = g+1 \geq \deg(F(x))$ then this is the only pole in $U_0$, and hence the residue is non-zero.
This leaves the case $g+1 < \deg(F(x))$, where we have poles at both $P_\infty$ and $P_\infty'$, and hence need to show that the residues at these two points do not add to zero.


Again, if $i-j=-1$ and $\infty$ is branch point then we again have a pole of order one at $P_\infty$, and hence a non-zero residue there.
Also, even if $\infty$ is not a branch point it still suffices to compute the residue on $X\backslash U_\infty$, and we see that if $0$ is a branch point this is non-zero.
So we again need only consider the case when both $\infty$ and $0$ are not branch points.

We start by noticing that if we let $P_0 = (0,a)$ and $P_0' = (0,a+H(0))$ then we know that $s=y-a$ and $t=y-(a+H(0))$ are uniformising parameters at $P_0$ and $P_0'$ respectively.
So to work out the residue of $\frac{1}{x}dx$ at $P_0$ we wish to find the $c_{-1}$ coefficient in the expansion
\begin{align*}
\frac{1}{x}dx & = \sum_{i \geq -1} c_i s^i d(y-a) \\
& = \sum_{i\geq -1} c_i s^i dy \\
& = \sum_{i \geq -1} c_i s^i \left(\frac{F' - yH'}{H} \right) dx,
\end{align*}
where the last line follows from \eqref{divdyp=2} and $c_i \in k$.
Now $\left(\frac{F' -yH'}{H}\right)$ cannot have a pole at $0$ since $H(0) \neq 0$, so the only part of the series which can contain a $\frac{1}{x}$ term is the $i=-1$ term.
We will use this and compare the coefficients to work out the residue at the points. 

In other words we wish to find the $\frac{1}{x}$ term in 
\[
c_{-1}s^{-1}\left(\frac{F' - yH'}{H} \right) = \frac{c_{-1}}{y-a} \left( \frac{F' - yH'}{H} \right).
\]
We would like to remove the $y$ term from the denominator of this.
After noticing that 
\[
(y-a)(y-(H+a)) = y^2 - yH - a(H-a) = F- a(H-a)
\]
we clearly see that 
\begin{align*}
\frac{c_{-1}}{y-a} \left( \frac{F' - yH'}{H} \right) & = c_{-1} \left( \frac{(F'-yH')(y-(H+a))}{H(F-a(H+a))} \right) \\
& = c_{-1} \left( \frac{F'y - F'(H+a) - (F -yH)H' - yH'(H-a)}{H(F-a(H+a))} \right) \\
& = \frac{c_{-1}(F'(H+a) - FH')}{H(F-a(H+a))} + \frac{c_{-1}y(F' - aH')}{H(F-a(H+a))},
\end{align*}
where we have collected together the $y$ terms, since clearly they cannot contain a $\frac{1}{x}$ term.

We then perform a similar operation on the equivalent term for the expansion around $P_0'$, which is
\[
\frac{d_{-1}(F' - yH')}{H(y - (H(0) - a))}.
\]
As before, we remove the $y$ term from the denominator, this time using the identity
\begin{align*}
(y-(H(0)+a))(y - (H+H(0)+a)) &  = y^2 - yH - (H(0) - a)(H - H(0) - a) \\
& = F - (H(0)-a)(H - H(0) - a).
\end{align*}
From this we can then derive. 
\begin{align*}
d_{-1}t^{-1} \left( \frac{F' - yH'}{H} \right)  = & d_{-1}\left( \frac{(F'  - yH')(y+ H + H(0) + a)}{H(F -(H(0)-a)(H - H(0) -a ))} \right) \\
 =&  \frac{d_{-1}(HF' + F'H(0) + aF' - FH')}{H(F-(H(0) - a)(H - H(0) - a))}  \\
& - \frac{d_{-1}y(F' - H'H(0) - aH')}{H(F - (H(0) - a)( H - H(0) - a))}.
\end{align*}



\end{proof}



In order to state a basis of $\derhamhone$, as well as to shorten the proof of the following theorem, we define the following polynomials. 
We suppose that $1 \leq i \leq g$.
Then when $p\neq 2$ we define
\[
s_i(x) := xf'(x) - 2if(x) \in k[x]
\]
and when $p = 2$ we define
\begin{equation}\label{capitals}
S_i(x,y) := xF'(x) + y(xH'(x) + iH(x))\in k[x]\oplus yk[x] \subseteq k(x,y).
\end{equation}

We now decompose these polynomials into two parts, which will be used in the sequel.
Firstly, we write $s_i(x)$ as $s_i(x) = \phi_i(x) + \psi_i(x)$, where $\psi_i(x)\in k(x)$ and $\phi_i(x) \in k[x]$ are the unique polynomials such that the degree of $\psi_i (x)$ is at most $g+1$ and $x^{g+2}$ divides $\phi_i(x)$.


Secondly, we write $S_i(x,y)$ as $S_i(x,y) = \Phi_i(x,y) + \Psi_i(x,y)$, where $\Phi_i(x,y), \Psi_i(x,y) \in k[x,y]$ are the unique polynomials such that $\Phi_i(x,y)$ is divisible by $x^i$ and no monomial of $\Psi_i(x,y)$ has a factor of $x^i$.

Viewing $\derhamhone$ as a quotient of \eqref{derhamconditions}, we now give a $k$-vector space basis of $\derhamhone$.
\begin{thm}\label{basis}

If $p \neq 2$ then the residue classes of 
\begin{equation}\label{one}
 \left( \left( \frac{\psi_i(x)}{2yx^{i+1}}\right) dx, \left(\frac{-\phi_i(x)}{2yx^{i+1}}\right) dx, x^{-i}y\right), i=1, \ldots ,g,
\end{equation}
along with the residue classes of 
\begin{equation}\label{two}
 \left( \frac{x^{i}}{y} dx , \frac{x^{i}}{y} dx, 0 \right), i = 0,\ldots ,g-1,
\end{equation}
form a basis of $\derhamhone$.

On the other hand, if $p=2$ then the residue classes of the elements 
\begin{equation}\label{three}
\left( \left(\frac{\Psi_i(x,y)}{x^{i+1}H(x)}\right) dx, \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} \right) dx, x^{-i}y \right), i =1, \ldots , g,
\end{equation}
together with the residue classes of 
\begin{equation}\label{four}
\left( \frac{x^{i}}{H(x)} dx, \frac{x^{i}}{H(x)} dx, 0 \right), i=0, \ldots, g-1,
\end{equation}
form a basis of $\derhamhone$.
\end{thm}

Before proving this theorem we use it to prove the following corollary.

\begin{cor}
The action of $G$ on $\derhamhone$ is faithful unless $G$ contains a hyperelliptic involution and $p=2$, in which case the action of the involution $\sigma:(x,y) \mapsto (x,y+H(x))$ is trivial.
\end{cor}

\begin{proof}
Recall that $H^0(X,\Omega_X)$ injects into $\derhamhone$.
Then if $p \neq 2$ or $G$ does not contain a hyperelliptic involution it follows from \cite[Thm. 4.2]{faithfulaction} that $G$ acts faithfully on $H^0(X,\Omega_X)$, and hence $G$ acts faithfully on $\derhamhone$.

We now suppose that $p=2$ and that $G$ contains a hyperelliptic involution, which we denote by $\sigma$.
By the same theorem from \cite{faithfulaction} as used in the last paragraph, we know that $\sigma$ acts trivially on $\hzero$.

Since $\hzero$ is dual to $\hone$ we know that $G$ also does not act faithfully on $\hone$.
We can study exactly why this is from the view of \cech cohomology, and this will also help to determine the action of $\sigma$ on $\derhamhone$.
If we fix a natural number $i\in \{1, \ldots ,g\}$ then $\sigma$ maps $\frac{y}{x^i}$ to $\frac{y}{x^i} + \frac{H(x)}{x^i}$. 
Now we can split $\frac{H(x)}{x^i}$ as follows, 
\begin{equation*}
\frac{H(x)}{x^i} =  \frac{b_{i-1}x^{i-1} + \ldots + b_1x + b_0}{x^i} - \left( - \frac{x^d + b_{d-1}x^{d-1} + \ldots + b_ix^i}{x^i} \right),
\end{equation*}
and since this is clearly the difference of an element of $\cO_X(U_0)$ and an element of $\cO_X(U_\infty)$ we see that $\frac{H(x)}{x^i}$ is zero in $\hone$.
We let 
\[
H_{1,i}(x) = b_{i-1}x^{i-1} + \ldots + b_1x
\]
and 
\[
H_{2,i}(x) = -( x^d + b_{d-1}x^{d-1} + \ldots + b_ix^i).
\]

We now consider the action of $\sigma$ on the entries in \eqref{three}.
Firstly we see that
\begin{align*}
\sigma \left( \frac{-\Psi_i(x,y)}{x^{i+1}H(x)} dx\right) & = \frac{-\sigma(\Psi_i(x,y))}{x^{i+1} H(x)} dx \\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)} + \frac{H(x)(xH_{1,i}'(x) + iH_{1,i}'(x))}{x^{i+1}H(x)}dx\\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)} + \frac{xH_{1,i}'(x) + iH_{1,i}(x)}{x^{i+1}}dx \\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)} +  \frac{H_{1,i}'(x)}{x^i}dx + \frac{iH_{1,i}'(x)}{x^{i+1}}dx \\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)} +  \frac{1}{x^i}d\left( H_{1,i}(x) \right) + H_{1,i}(x) d \left( \frac{1}{x^i} \right) \\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)} + \left( \frac{H_{1,i}(x)}{x^i} \right),
\end{align*}
where the second equality follows from \eqref{capitals} and the fact that $\sigma(y) = y + H(x)$.

Similarly we can derive
\begin{equation*}
\sigma \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} dx \right)  = \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} \right) dx + d \left( \frac{{}_iH_{2,i}(x)}{x^i} \right).
\end{equation*}
Lastly, it is clear that $\sigma(x^{-i}y) = x^{-i}(y+H(x))$.


We can now describe exactly how sigma acts on the elements of \eqref{three} using $H_{1,i}(x)$ and $H_{2,i}(x)$:
\begin{multline}
\sigma \left( \left( \left(\frac{-\Psi_i(x,y)}{x^{i+1}H(x)}\right) dx, \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} \right) dx, x^{-i}y \right)\right) = \\
 \left( \left(\frac{-\Psi_i(x,y)}{x^{i+1}H(x)} \right) dx + d\left(\frac{H'_{1,i}(x)}{x^i}\right),  \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} \right) dx+ d\left(\frac{H'_{2,i}(x)}{x^i} \right), \frac{y+H(x)}{x^i} \right).
\end{multline}
So the action of $\sigma$ on the basis elements in \eqref{three} amounts to adding 
\[
\left( d\left(\frac{H_{1,i}'}{x^i}\right), d\left(\frac{H_{2,i}'}{x^i}\right), \frac{H(x)}{x^i} \right),
\]
which clearly satisfies the conditions of \eqref{quotient} and hence is zero.
So the action of the involution $\sigma$ on $\derhamhone$ is trivial and hence the action of the group $G$ is not faithful.\todo{consider computing the action when $p\neq 2$}
\begin{comment}
Hence the action is trivial if and only if ${}_iH_1'(x)dx = {}_iH_2'(x)dx =0$.
This cannot happen though, since we can always find an $l\in \{0,1\}$ such that $l \not\equiv d\ \text{mod}\ 2$, and then $d\left({}_iH_2(x)\right) = {}_iH_2'(x)dx \neq 0$, as we can see from the leading term (unless of course $d$ is zero, in which case $d\left({}_iH_1(x)\right) \neq 0$).
\end{comment}
\end{proof}


We now prove Theorem \ref{basis}.

\begin{proof}
We make use of the fact that the short exact sequence \eqref{ses} splits as a sequence of vector spaces over $k$, and that we know bases of the outer two terms.

It is clear that \eqref{two} and \eqref{four} are elements of \eqref{derhamconditions}, and it follows from \cite[Thm 6.1]{faithfulaction} that they are the image of the basis of $H^0(X,\Omega_X)$ in $\derhamhone$.

Moreover, it is obvious that if the elements \eqref{one} and \eqref{three} are in \eqref{derhamconditions} then they will map to the basis of $\hone$ given in Lemma \ref{basish1}.
So we need only show that the first two terms in \eqref{one} and \eqref{three} satisfy the conditions stated in \eqref{derhamconditions} to be in $\derhamhone$.
For the rest of the proof we fix $i \in \{1, \ldots ,g\}$.


We start with the case $p\neq 2$, and observe that
\begin{align*}
\left(  \frac{\psi_i(x)}{2yx^{i+1}}  - \frac{-\phi_i(x)}{2yx^{i+1}} \right) dx & =  \frac{s_i(x)}{2yx^{i+1}} dx \\
& =  \frac{1}{2yx^i} \left( f' - \frac{2if}{x} \right) dx \\
& =  \frac{x^i}{2y} \left( \frac{f'}{x^{2i}}dx -\frac{2if}{x^{2i+1}} dx \right) \\
& =  \frac{x^i}{2y} \left( fd\left(\frac{1}{x^{2i}}\right) + \frac{1}{x^{2i}}df \right) \\
& =  \frac{x^i}{2y}d(fx^{-2i}) \\
& =  \frac{x^i}{2y} d\left(\left(yx^{-i}\right)^2\right) \\
& =  d(yx^{-i}),
\end{align*}
with the penultimate line following from the defining equation \eqref{definingequationpnot2}.
This shows that the elements \eqref{one} satisfy $df_{0, \infty} = \omega_0 - \omega_\infty$, one of the conditions of \eqref{derhamconditions}.
Since we saw in the proof of Lemma \ref{basish1} that $\frac{y}{x^i}$ is regular on $U_0\cap U_\infty$ it only remains to show that $\frac{\phi_i}{2yx^{i+1}}dx$ and $\frac{-\psi_i}{2yx^{i+1}}dx$ are regular on $U_\infty$ and $U_0$ respectively.


In order to do this we define $\alpha_{j,i} \in k$ for $0\leq j \leq 2g+2$ to satisfy the equation
\[
s_i(x) = \alpha_{2g+2,i}x^{2g+2} + \ldots + \alpha_{0,i},
\]
so that
\[
\phi_i(x) = \alpha_{2g+2,i}x^{2g+2} + \ldots + \alpha_{g+2,i}x^{g+2} \ {\rm and } \ \psi_i(x) = \alpha_{g+1,i}x^{g+1} + \ldots + \alpha_{0,i}.
\]
Note that it is possible for any of $\alpha_{j,i}$ to be zero. Indeed, it is possible for either $\phi_i(x)$ or $\psi_i(x)$ to be zero.
Whenever they are non-zero we denote their degrees as polynomials in $x$ by $d_\phi$ and $d_\psi$ respectively. From the definition of $\phi_i(x)$ and $\psi_i(x)$ we know that $0 \leq d_\psi \leq g+1$ and $g+1 < d_\phi \leq 2g+2$ for all $1 \leq i \leq g$.
\todo{remove d psi? - will keep for now in case useful later}


We now show that $\frac{-\phi_i}{2yx^{i+1}}dx$ and $\frac{\psi_i}{2yx^{i+1}}dx$ are regular on $U_\infty$ and $U_0$ respectively.
We may assume that $\phi_i$ and $\psi_i$ are non-zero, since the zero function is regular everywhere.
The divisor of $\frac{-\phi_i}{2yx^{i+1}}dx$ is

\begin{align*}
\di\left( \frac{-\phi_i}{2yx^{i+1}}dx \right) & =  \di(\phi_i) -\di(y) - \di(x^{i+1}) + \di (dx) \\
& =  \di(\phi_i) - ( R - (g+1)D_\infty) - ((i+1)D_0 - (i+1)D_\infty) + (R - 2D_\infty) \\
& =  \left( \di_0\left( \frac{\phi_i}{x^{g+2}}\right) + (g+2)D_0 - d_\phi D_\infty\right) - (i+1)D_0 + (g+i)D_\infty \\
& \geq  \di_0\left( \frac{\phi_i}{x^{g+2}}\right) + (g+2)D_0 - (2g+2)D_\infty - (i+1)D_0 + (g+i)D_\infty \\
& =  \di_0\left( \frac{\phi_i}{x^{g+2}} \right) + (i-g-2)D_\infty + (g-i+1)D_0,
\end{align*}
where the second equality makes use of \eqref{pnot2divisors}.
Since $i \leq g$ the differential $\frac{-\phi_i}{2yx^{i+1}}dx$ is regular on $U_\infty = X\backslash \pi^{-1}(\infty)$.

Similarly the divisor of $\frac{\psi_i}{2yx^{i+1}}dx$ is

\begin{align*}
\di \left( \frac{\psi_i}{2yx^{i+1}}dx\right) & =  \di(\psi_i) - \di(y) - \di(x^{i+1}) + \di (dx) \\
& =  \di (\psi_i ) -(R - (g+1)D_\infty) - ((i+1)D_0 - (i+1)D_\infty) + (R -2D_\infty) \\
& =  \di(\psi_i) + (g+i)D_\infty -(i+1)D_0 \\
& =  (\di_0(\psi_i) -d_\psi D_\infty) + (g+i)D_\infty -(i+1)D_0 \\
& \geq \left( \di_0(\psi_i) - (g+1)D_\infty \right) + (g+i)D_\infty -(i+1)D_0 \\
& =  \di_0(\psi_i) + (i-1)D_\infty - (i+1)D_0.
\end{align*}
Again, the second equality uses \eqref{pnot2divisors}, and since $i\geq 1$ we conclude that $\frac{\psi_i(x)}{2yx^{i+1}}dx$ is regular on $U_0 = X \backslash \pi^{-1}(0)$, completing the $p\neq 2$ case.


We now suppose that $p=2$.
We remind the reader that this allows us to change signs between positive and negative as we wish.
We see that
\begin{align*}
\left( \left( \frac{ \Psi_i}{x^{i+1}H} \right) + \left( \frac{\Phi_i}{x^{i+1}H} \right) \right) dx & =  \frac{S_i}{x^{i+1}H}dx \\
& =  \left( \frac{F'}{x^iH} + \frac{yH'}{x^iH} + \frac{iy}{x^{i+1}} \right) dx \\
& =  \frac{1}{x^i}\left( \frac{F' + yH'}{H} \right) dx + \frac{iy}{x^{i+1}}dx \\
& =  x^{-i}dy + yd \left( x^{-i}\right) \\
& =  d\left( yx^{-i}\right),
\end{align*}
with the fourth equality following from \eqref{divdyp=2}.
We have also already seen in the proof of Lemma \ref{basish1} that $\frac{y}{x^i}$ is regular on $U_0 \cap U_\infty$.
So in order to prove that for $i\in \{1, \ldots, g\}$ the elements of \eqref{three} are satisify the conditions of \eqref{derhamconditions} it only remains to show that the differentials $\frac{\Phi_i}{x^{i+1}H}dx$ and $\frac{\Psi_i}{x^{i+1}H}dx$ are regular on $U_\infty$ and $U_0$ respectively.


We define ${}_iA_{j} \in k$ for $1 \leq j \leq 2g+2$, and ${}_iB_k \in k$ for $1\leq k \leq g+1$ by the equation
\[
S_i(x,y) = {}_iA_{2g+2}x^{2g+2} + \ldots + {}_iA_1 x + y({}_iB_{g+1} x^{g+1} + \ldots + {}_iB_1 x + {}_iB_0).
\]
Note that many of these coefficients may be zero.
In particular we remark that the $x^i$ term of $xH'(x) + iH(x)$ is exactly zero, since it is precisely $x \cdot ib_ix^{i-1} + ib_i x^i = 2ib_ix^i = 0$.


We can now define the following polynomials:
\begin{equation}\label{Split}
\begin{split}
\Phi_i^x(x) & =  {}_iA_{2g+2}x^{2g+2} + \ldots + {}_iA_{i+1}x^{i+1} \\
\Psi_i^x(x) & =  {}_iA_ix^i + \ldots + {}_iA_1x \\
\Phi_i^y(x) & =  {}_iB_gx^g + \ldots {}_iB_{i+1}x^{i+1} \\
\Psi_i^y(x) & =  {}_iB_{i-1}x^{i-1} + \ldots + {}_iB_1x + {}_iB_0.
\end{split}
\end{equation}
We denote the degrees of these polynomials by $d_{\Phi}^x, d_{\Psi}^x, d_{\Phi}^y$ and $d_{\Psi}^y$ respectively.

Clearly $\Phi_i(x,y) = \Phi_i^x(x) + y\Phi_i^y(x)$ and $\Psi_i (x,y)= \Psi_i^x(x) + y\Psi_i^y(x)$, and we will use these splittings to show that $\frac{ \Phi_i(x) dx}{x^{i+1}H}$ and $\frac{\Psi_i(x) dx}{x^{i+1}H}$ are regular on $U_\infty$ and $U_0$ respectively.

We start by computing the divisor of $\frac{dx}{x^{i+1}H}$, since it is a common component to all the differentials we need to look at.
This yields
\begin{align}
\di \left( \frac{dx}{x^{i+1}H} \right) & = \di(dx) - \di (x^{i+1}) - \di (H) \nonumber \\
& = (R-2D_\infty) - ((i+1)D_0 - (i+1)D_\infty) - (R - (g+1)D_\infty) \nonumber \\
& = (g+i)D_\infty - (i+1)D_0,
\end{align}
using \eqref{divdxp=2}, \eqref{divhp=2} and \eqref{divxp=2}.
We now use this along with \eqref{divyp=2} and the polynomials we defined in the preceding paragraphs to complete the proof.

We begin by computing the divisors associated to $\Phi_i$.
Firstly,
\begin{align*}
\di \left( \frac{\Phi_i^x dx}{x^{i+1} H} \right)  = &  \di(\Phi_i^x) -(i+1)D_0 + (g+i)D_\infty\\
 = & \left( \di_0(\Phi_i^x) -d_\Phi^xD_\infty\right) -(i+1)D_0 + (g+i)D_\infty\\
 \geq & \di_0(\Phi_i^x) - (2g+2)D_\infty - (i+1)D_0 + (g+i)D_\infty \\
 = &  \di_0(\Phi_i^x) - (i+1)D_0 + (i-2-g)D_\infty \\
 =  & \di_0 \left( \frac{\Phi_i^x}{x^{i+1}} \right) + (i-g-2)D_\infty.
\end{align*}
From this we see that the differential $\frac{\Phi_i^xdx}{x^{i+1}H}$ is clearly regular on $U_\infty = X \backslash \pi^{-1}(\infty)$.

We now compute the divisor of the other half of $\frac{\Phi_i}{x^{i+1}H}dx$, namely
\begin{align*}
\di\left(\frac{y\Phi_i^y dx}{x^{i+1}H} \right)  = & \di(y) + \di(\Phi_i^y) -(i+1)D_0 + (g+i)D_\infty\\
 = & \di(y) + \di_0(\Phi_i^y) - d_\Phi^yD_\infty -(i+1)D_0 + (g+i)D_\infty \\
 \geq & \di(y) + \di_0(\Phi_i^y) - (g+1)D_\infty - (i+1)D_0 + (g+i)D_\infty \\
 = & \di(y) + \di_0\left(\frac{\Phi_i^y}{x^{i+1}} \right) + (i-1)D_\infty.
\end{align*}
From \eqref{divyp=2} we see that $y$ only has poles at points in $\pi^{-1}(\infty)$, and hence this completes the proof that $\frac{\Phi_i dx}{x^{i+1}H}$ is regular on $U_\infty = X \backslash \pi^{-1}(\infty)$.

Now we complete the same computations on $\Psi_i$, starting with $\Psi_i^x$:
\begin{align*}
\di\left( \frac{\Psi_i^x dx}{x^{i+1}H} \right)  & =   \di(\Psi_i^x)  - (i+1)D_0 + (g+i)D_\infty \\
& = (\di_0(\Psi_i^x) -d_\Psi^xD_\infty) - (i+1)D_0 + (g+i)D_\infty \\
 & \geq   \di_0(\Psi_i^x ) - iD_\infty - (i+1)D_0 + (g+i)D_\infty \\
 & =   \di_0(\Psi_i^x) - (i+1)D_0 + gD_\infty,
\end{align*}
and it is clear that the divisor is positive on $U_0 = X \backslash \pi^{-1}(0)$.

For the other half of the differential we need to consider seperate cases.
If we assume that $\infty$ is branch point then  using \eqref{divyp=2} we see that
\begin{align*}
\di\left(\frac{y\Psi_i^y dx}{x^{i+1}H} \right)  =  & \di_0(y) - (2g+1)[P_\infty] + \di(\Psi_i^y) - (i+1)D_0 + (g+i)[P_\infty] \\
 =  & \di_0(y) + \di(\Psi_i^y) -(i+1)D_0 + (2i -1)[P_\infty] \\
 = &  \di_0(y) + \di_0(\Psi_i^y) - d_\Psi^y[P_\infty] - (i+1)D_0 + (2i-1)[P_\infty] \\
 \geq &  \di_0(y) + \di_0(\Psi_i^y) -(i-1)[P_\infty] -(i+1)D_0 + (2i-1)[P_\infty] \\
 =   &\di_0(y) + \di_0(\Psi_i^y) -(i+1)D_0 + [P_\infty],
\end{align*}
which is clearly positive on $U_0$.
On the other hand, if $\infty$ is not a branch point then we have
\begin{align*}
\di\left(\frac{y\Psi_i^y dx}{x^{i+1}H} \right)  =  & \di(y) + \di(\Psi_i^y) - (i+1)D_0 + (g+i)D_\infty \\
= & \di(y) + \di_0(\Psi_i^y) - (i+1)D_0 + (g+i - d_\Psi^y)D_\infty \\
\geq & \di(y) + \di_0(\Psi_i^y) - (i+1)D_0 + (g+1)D_\infty. \\
\end{align*}
Since we know from \eqref{divyp=2} that $y$ cannot have a pole of order greater $g+1$ at $P_\infty$ or $P_\infty'$, and only has poles at these points, it follows that the differential $\frac{y\Psi_i^y dx}{x^{i+1}H}$ is regular on $U_0 = X \backslash \pi^{-1}(0)$.
Thus we have completed the proof.


\end{proof}

\section{Computing the residue}
\todo[inline]{check that don't need to change any basis elements after multiplying $s_i$ by $x$}

Introduction needs to be finalised once the proof in the previous section is completed.
In particular, if the exact residue can be computed then we may as well do so.
Currently we are assuming in this section that $\infty$ and 0 are a branch point.

\begin{lem}
Suppose that $\infty\in \mathbb P_k^1$ is a branch point of $\pi$.
If $p \neq 2$ then ${\rm res}_{P_\infty}(\frac{1}{x}dx) = -2$.
If $p=2$ then ${\rm res}_{P_\infty}\left(\frac{ydx}{xH(x)}\right) = 1$.
In particular, this shows that the basis of $\hone$ in Lemma \ref{basish1} is dual to the basis given for $\hzero$ in \cite{faithfulaction}.
\end{lem}

\begin{proof}

We first consider the case $p\neq 2$.
We note that $t:= \frac{y}{x^{g+1}}$ is a uniformising parameter at $P_\infty$ as can be seen by computing the order of $t$ at $P_\infty$ as follows
\begin{align}
\ord_{P_\infty}(t) & =  \frac{1}{2}\ord_{P_\infty}(t^2) \\
  & =  \frac{1}{2}\ord_{P_\infty}\left( \frac{f}{x^{2g+2}} \right) \\
& =  \frac{1}{2}\ord_{P_\infty}(f(x)) - \frac{1}{2}\ord_{P_\infty}(x^{2g+2})\\
& =  -(2g+1) + (2g+2) \\
& =  1.
\end{align}

We now write $\frac{1}{x}dx$ in terms of $dt$.
By the quotient rule we know that
\begin{align*}
dt^2 & =  d \left( \frac{f}{x^{2g+2}} \right) \\
& =  \frac{x^{2g+2}f' - (2g+2)x^{2g+1}f}{x^{4g+4}} dx \\
& =  \frac{1}{x^{2g+2}} \left( f' - \frac{(2g+2)f}{x} \right) dx
\end{align*}
from which we conclude that
\[
\frac{1}{x}dx = \frac{2tx^{2g+1}}{\left(\frac{f' - (2g+2)f}{x} \right)} dt.
\]


We now let $p(x) = \left(\frac{(2g+2)f(x)}{x} - f'(x)\right)$, and noting that the coefficient of $x^{2g}$ in $p(x)$ is $(2g+2)a_{2g+1} - (2g+1)a_{2g+1} = a_{2g+1}$, we see that $h(x)$ is a degree $2g$ polynomial in $x$.
We wish to compute the coefficient of $t^{-1}$ in the expansion of $\frac{1}{x}dx$ at $P_\infty$ and for this we require the following expansions
\begin{align}
\frac{p(x)}{x^{2g+1}} = \frac{a_{2g+1}x^{2g}}{x^{2g+1}} + \ldots = \frac{a_{2g+1}}{x} + \ldots \qquad \text{and} \qquad t^2 = \frac{f}{x^{2g+2} } = \frac{a_{2g+1}}{x} + \ldots
\end{align}

Since $\ord_{P_\infty}\left(\frac{p(x)}{x^{2g+1}}\right) = 2$ we know that $\frac{p(x)}{x^{2g+1}} = \sum_{j\geq 2} c_j t^j$ for some $c_j\in k$, and from the above computations we can see that $c_2 = 1$.
We also know that $\frac{x^{2g+1}}{p(x)} = \sum_{k\geq -2} d_kt^k$, for some $d_k\in k$, and clearly $d_{-2} = 1$.
Now
\[
\frac{1}{x}dx = \left( -2t \cdot \sum_{i\geq -2} d_it^i\right) dt 
\]
so we see that $\res_{P_\infty}\left( \frac{1}{x} dx\right) = 2$.
This completes the proof of the lemma when $p\neq 2$.

We now turn to the case when $p=2$.
We now wish to compute the residue of $\frac{ydx}{xH(x)}$ at $P_\infty$.
We start by noting that $t = \frac{y}{x^{g+1}}$ is a uniformising parameter at $P_\infty$ which we check by computing the divisor:
\begin{align*}
\di(t) & = \di_0(y) - (2g+1)[P_\infty] -(g+1)D_0 + (g+1)D_\infty \\
& = \di_0(y)-(g+1)D_0 + [P_\infty],
\end{align*}
using \eqref{divxp=2} and \eqref{divyp=2}.
So clearly $t$ is a uniformising parameter at $P_\infty$.

We now wish to write $\frac{y}{xH(x)}dx$ as $r(x,y)dt$ for some $r \in k(x,y)$.
We first write $dy$ in terms of $dx$.
Since
\begin{align*}
0 & =  dy^2 \\
& =  d(F+yH) \\
& =  F'dx + Hdy + yH'dx
\end{align*}
we conclude that
\[
dy = \left( \frac{F'+yH'}{H} \right) dx.
\]

We also rewrite $dt$ as follows:
\begin{align*}
dt & =  d\left( \frac{y}{x^{g+1}} \right) \\
& =  yd\frac{1}{x^{g+1}} + \frac{1}{x^{g+1}}dy \\
& =  \frac{1}{x^{g+1}} \left( \frac{(g+1)y}{x} + \frac{F'+yH'}{H} \right) dx \\
& =  \frac{1}{x^{g+1}} \left( \frac{xF'}{y} + xH' + (g+1)H \right) \frac{y}{Hx} dx.
\end{align*}

In total we then have
\[
\frac{y}{xH(x)}dx = \frac{x^{g+1}y}{S_{g+1}(x,y)}dt
\]
where $S_{g+1}(x,y)$ is as defined in \eqref{capitals}.

Since we saw in the proof of Lemma \ref{basish1} that $\frac{y}{xH(x)}dx$ has a pole of order at $P_\infty$, we have the Taylor expansion $\frac{x^{g+1}y}{S_{g+1}(x,y)} = \sum_{i\geq -1} c_i t^i$, with $c_i \in k$, and we wish to compute $c_{-1}$.
We shall do this by computing the coefficient $d_1$ of $t$ in the expansion $\frac{S_{g+1}(x,y)}{x^{g+1}y} = \sum_{i\geq 1}d_it^i$.
We can split up $\frac{S_{g+1}(x,y)}{x^{g+1}y}$ into three terms, namely $\frac{xF'}{x^{g+1}y}$, $\frac{yxH'}{x^{g+1}y}$ and $\frac{(g+1)yH}{x^{g+1}y}$.
Each of these terms can of course be written as a power series in $t$.
However, to compute $d_1$ we need only compute the coefficient of $t$ in these power series.
Since $\infty$ is a branch point then $H$ has degree at most $g$ (and hence $xH'$ also has degree at most $g$).
It then follows that the order of both $\frac{xH'}{x^{g+1}}$ and $\frac{(g+1)H}{x^{g+1}}$ at $P_\infty$ is at least 2, and hence the coefficient of $t$ in their power series expansion is zero.
The order of $\frac{xF'}{x^{g+1}y}$ at $P_\infty$ on the other hand is precisely 1, and hence the coefficient of $t$ in the power series expansion of $\frac{xF'}{x^{g+1}y}$ will determine $d_1$.


Suppose that $F = \alpha_{2g+1}x^{2g+1} + \alpha_{2g}x^{2g} + \ldots + \alpha_1x^1 + \alpha_0$.
Then $xF'= \alpha_{2g+1}x^{2g+1} + \alpha_{2g-1}x^{2g-1} + \ldots + \alpha_1x^1$; i.e. the terms with an even power are removed.

So the only term in $\frac{xF'}{x^{g+1}y}$ of order 1 at $P_\infty$ is $\frac{\alpha_{2g+1}x^{2g+1}}{x^{g+1}y} = \frac{\alpha_{2g+1}x^{g}}{y}$.
Since
\[
\frac{\alpha_{2g+1}x^g}{y} = \frac{\alpha_{2g+1}}{x}t^{-1}
\]
and $\frac{1}{x} = \sum_{i\geq 2}e_it^i$ for some $e_i \in k$, if we compute $e_2$ then we will have effectively computed $d_1$.
Now $t^2 = \frac{F }{x^{2g+2}}+ \frac{Hy}{x^{2g+2}}$, and clearly $\frac{Hy}{x^{2g+2}}$ has no monomial term of the form $\frac{c}{x}$ with $c \in k$.
On the other hand
\[
\frac{F}{x^{2g+2}} = \frac{\alpha_{2g+1}}{x} + \ldots
\]
Hence we conclude that $e_2 = \frac{1}{\alpha_{2g+1}}$.
It follows that $d_1 = \alpha_{2g+1} \cdot \frac{1}{\alpha_{2g+1}} = 1$.
We finally use this to conclude that $c_{-1} = \frac{1}{d_{1}} = 1$.




\end{proof}
\begin{comment}

\section{Stability of modular curves in characteristic greater than 2}
In this section we consider some modular hyperelliptic curves and how their automorphism groups at on the first de Rham cohomology group of the curves.
The automorphism groups of these curves can be found in \cite{automorphismshyperellipticmodular}.
We start by considering the curve $X_0(22)$, which can defined by the equation
\begin{equation*}
y^2 = (x^3+ 4x^2 + 8x + 4)(x^3 + 8x^2 + 16x + 16).
\end{equation*}
The automorphism group of this curve is, in general, $\mathbb Z_2 \times \mathbb Z_2$, with the action given by 
\begin{align}
\omega_2\colon (x,y) & \mapsto \left( \frac{4}{x} , \frac{8y}{x^3} \right), \\
\omega_{11}\colon (x,y) & \mapsto (x, -y ).
\end{align}
Note that we are using the notation of \cite{automorphismshyperellipticmodular} for consistency.
We now study how this group action affects the basis of $\derhamhone$.
In particular, we show that the basis associated to $\hone$ in $\derhamhone$ is not stable under the action of the automorphism group.
For each $i \in \{ 1, \ldots , g\}$ we let 
\begin{equation*}
\nu_i = \left( \left( \frac{-\psi_i(x)}{2yx^i} \right) dx , \left( \frac{\phi_i(x)}{2yx^i} \right) dx, x^{-i}y \right).
\end{equation*}
We then note that 
\[
\omega_2(dx) = d( \omega_2(x)) = d\left( \frac{4}{x} \right) = \frac{-4}{x^2}dx.
\]
If we recall that 
\[
s_i(x) = \alpha_{2g+1}^ix^{2g+1} + \ldots + \alpha_0^i
\]
then we can see that the $\omega_2$ acts as follows:
\begin{equation}\label{omega11action}
\begin{split}
\omega_2 (\nu_i) & = \left( -\sum_{j = g+1}^{2g+1} \left( \frac{\alpha_j^i 4^{j-i}x^3}{2x^{j-i}y} \right) \frac{-4}{x^2} dx, \sum_{j = 0}^{g} \left(\frac{\alpha_j^i 4^{j-i} x^3}{2x^{j-i}y} \right) \frac{-4}{x^2}dx , \frac{8yx^i}{4^i x^3} \right) \\
& = \left( \sum_{j=g+1}^{2g+1} \left( \frac{\alpha_j4^{i-j+1}}{2yx^{j-i-1}} \right)dx, \sum_{j = 0}^{g} \left( \frac{-\alpha_j^i 4^{j-i+1}}{2yx^{j-i-1}} \right) dx, \frac{2yx^{i-3}}{4^{i-1}} \right).
\end{split}
\end{equation}

Now it appears that these terms are similar to those of $s_i \left( \frac{4}{x} \right)$, so it would be good to see if we can somehow write $y^2$ in terms of  some function of $\omega_2(x) = \frac{4}{x}$.
We can do this, since of course $\omega_2(y)^2 = \omega_2(y^2) = \omega_2(f(x)) = \omega_2\left( f \left(\frac{4}{x} \right) \right)$.
From this we obtain the identity
\begin{equation*}
y^2 = \frac{x^6 f \left(\frac{4}{x} \right)}{8^2}.
\end{equation*}
From this we obtain
\begin{align*}
dy & = \frac{1}{2y \cdot 8^2} \left( f'\left(\frac{4}{x} \right) x^6 d\left(  \frac{4}{x} \right) + 6 f\left( \frac{4}{x} \right) x^5 dx \right) \\
& = \frac{1}{2y \cdot 8^2} \left( f'\left(\frac{4}{x} \right) \cdot (-4 x^4) + 6 f\left( \frac{4}{x} \right) x^5  \right) dx \\
\end{align*}

We can then use this to compute $d (\omega_2(x^{-i}y)) = d \left( \frac{8yx^{i-3}}{4^i} \right)$, which we now do:
\begin{align*}
d\left( \frac{8yx^{i-3}}{4^i} \right) & = \frac{8}{4^i} \left( x^{i-3}dy + ydx^{i-3} \right) \\
& = \frac{8}{4^i} \left( \frac{x^{i-3}}{2y8^2} \left( \frac{-4}{x^2} \cdot f'\left( \frac{4}{x}  \right) x^6 + 6x^5 f\left( \frac{4}{x} \right) \right) + (i-3)x^{i-4}y \right) dx \\
& = \frac{8}{4^i} \left( \frac{1}{2y8^2} \left(\frac{-4}{x^2} \cdot  f'\left( \frac{4}{x} \right) x^{i+3} + 6x^{i+2} f\left( \frac{4}{x} \right) \right) + \frac{(i-3)x^{i-4}x^6f \left( \frac{4}{x} \right)  }{y8^2} \right) dx \\
& = \frac{8}{4^i} \cdot \frac{x^{i+3}}{2y8^2} \left(\frac{-4}{x^2} \cdot  f' \left( \frac{4}{x} \right)  + \frac{6}{x} f \left( \frac{4}{x} \right)  + \frac{2(i-3)f \left( \frac{4}{x} \right)  }{x} \right) dx \\
& = \frac{x^{i+3}}{2 \cdot 4^i \cdot 8 \cdot y} \left(\frac{-4}{x^2} \cdot  f'\left( \frac{4}{x} \right)  + \frac{ 2i f \left( \frac{4}{x} \right) }{x} \right) dx \\
& = \frac{x^{i+1}}{4^{i+1}y} \left( -f' \left(\frac{4}{x} \right) + \frac{2if \left( \frac{4}{x} \right) x}{4} \right) dx.
\end{align*}
\todo[noline]{Apart from the minus sign in front of $f' \left( \frac{4}{x} \right)$ and a factor of two almost matches up - check computations}Note that the function before $dx$ here is precisely $\omega_2\left(\frac{s_i(x)}{2yx^i} \right)$.

This (almost) shows that
\[
\left( \omega_2 \left( \left( \frac{s_i(x)}{2yx^i} \right) dx \right) , 0, \omega_2( x^{-i}y)\right)
\]
is the zero element in $\derhamhone$.

We will now finally show that the basis of $\hone$ in $\derhamhone$ is not stable under the group action --- in particular, it is not stable under the action of $\omega_2$.
Now we fix $i = g-1$.
We can then clearly see from \eqref{omega11action} that if $\alpha_{g}^i$ is zero all the $x$ terms in the second co-ordinate will have degree at most $g-1$.
\begin{note}
By the action of $\omega_2$ we have $\frac{8^2y^2}{x^6} = f\left(\frac{4}{x} \right)$.
\end{note}

\begin{note}
For $\infty$ is not a branch point the same basis should work. 
Consider $y^2 = f(x)$ where the degree of $f(x)$ is $2g+2$ (i.e. $\infty$ is not ramified), with projection map $\pi : X \rightarrow \mathbb P_k^1$.
Then we can take the cover to be $U_0 := X \backslash \{\pi^{-1}(0)\}$ and $U_\infty := X \backslash \{\pi^{-1}(\infty)\}$.
Then we have $\frac{x^idx}{y} \cdot \frac{y}{x^{j}} = x^{i-j}dx$.
The divisor of this is then $(i-j)D_0 -(i-j)D_\infty + R - 2D_\infty$.
Then if $i-j = -1$ this has poles at at all points supported at by $D_0$ and $D_\infty$.


If $p=2$ and $\infty$ is not a branch point then we need to consider the defining equation $y^2 - h(x)y = f(x)$ where $\deg(h)=g+1$, and $\deg(f)$ can be anything from 0 to $2g+2$.
From work (which I think was not in 18 month report), if we suppose that $P_\infty$ and $P_\infty'$ are the two points in the pre-image of $\infty \in \mathbb P_k^1$, then the divisor of $y$ is
\[
\di(y) = \di_0(y) +(g+1 - \deg(f))[P_\infty] - (g+1)[P_\infty'],
\]
up to parity of $P_\infty$ and $P_\infty'$.
So then, after some computation, we get
\begin{multline*}
\di\left(\frac{yx^{i-j}}{H(x)}dx \right) = \di_0(y) + (i-j)D_0 + (g-1-(i-j))D_\infty \\ + (g+1-\deg(f))D_\infty -(g+1)[P_\infty'].
\end{multline*}
So if $i-j = -1$ we clearly have a pole of order 1 at $P_\infty'$.
\end{note}

Now a short note about whether the main theorem still holds if we do not specify the ramification points.
\begin{note}
Clearly when $p\neq 2$ the same basis holds. In the proof we use the fact that $\phi_i$ has a factor of at least $x^{g+1}$, giving a sufficient zero at $P_0$.
This factor is still in the polynomial if we increase its potential degree.
Of course, we may have to replace $P_0$ with $D_0$, but the essential point still holds.
Similarly, after possibly replacing $P_\infty$ by $D_\infty$ we have almost the same argument for $\psi_i$.
So the basis is the same when $p\neq2$.

When $p=2$ the basis is also the same.
We first note that whilst the degree of the highest and lowest ordered terms may change in \eqref{Split}, it is still the case that the coefficient $B_i^i =0$, using exactly the same arguments.
This allows us to use essentially the same arguments, again with the exception of changing $P_\infty$ and $P_0$ to $D_\infty$ and $D_0$.
\end{note}
\end{comment}


\bibliography{biblio}
\bibliographystyle{amsalpha}


\end{document}
