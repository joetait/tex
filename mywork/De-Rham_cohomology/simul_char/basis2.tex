% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[draft, 11pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
% \geometry{landscape} % set up the page for landscape
% read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options
\usepackage[obeyDraft]{todonotes}

%\usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage[all]{xy}
\usepackage{mathtools}
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
%\usepackage{hyperref}
% These packages are all incorporated in the memoir class to one degree or another...

%\usepackage[activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=1100,stretch=10,shrink=10]{microtype}
%\microtypecontext{spacing=nonfrench}
% activate={true,nocompatibility} - activate protrusion and expansion
% final - enable microtype; use "draft" to disable
% tracking=true, kerning=true, spacing=true - activate these techniques
% factor=1100 - add 10% to the protrusion amount (default is 1000)
% stretch=10, shrink=10 - reduce stretchability/shrinkability (default is 20/20)

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsopn}
\usepackage{amssymb}
\usepackage{etex}
%\usepackage{natbib}
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
%\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
%\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!
%\renewcommand{\familydefault}{\sfdefault}
%\usepackage{cabin}
%\usepackage{libertine}
%\usepackage[T1]{fontenc}

%Theorems and stuff
\theoremstyle{plain}
\newtheorem{defn}{Definition}[section]
\newtheorem{thm}[defn]{Theorem}
\newtheorem{cor}[defn]{Corollary}
\newtheorem{lem}[defn]{Lemma}
\newtheorem{prop}[defn]{Proposition}
\newtheorem{ex}[defn]{Example}
\newtheorem*{unnumthm}{Theorem}
\newtheorem{defnlem}[defn]{Definition/Lemma}
\newtheorem{defnthm}[defn]{Theorem/Definition}
\theoremstyle{remark}
\newtheorem*{rem}{Remark}
\newtheorem*{note}{Note}


\newcommand{\cO}{{\cal O}}
\newcommand{\ra}{\rightarrow}
\newcommand{\NN}{{\mathbb N}}
\newcommand{\PP}{{\mathbb P}}
\newcommand{\ZZ}{{\mathbb Z}}
\newcommand{\cL}{{\mathcal L}}
\newcommand{\cA}{{\mathcal A}}
\newcommand{\cD}{{\mathcal D}}
\newcommand{\cU}{{\mathcal U}}
\newcommand{\cech}{\v{C}ech }
\newcommand{\hzero}{{H^0(X,\Omega_X)}}
\newcommand{\hone}{H^1(X,\mathcal{O}_X)}
\newcommand{\cechhone}{\check{H}^1(\mathcal U,\mathcal O_X)}
\newcommand{\derhamhone}{H_{\text {dR}}^1(X/k)}
\newcommand{\cechhzero}{{\check{H}^0(X,\Omega_X)}}
\newcommand{\ubar}{\underset{\bar{}}}


\DeclareMathOperator{\aut}{Aut}
\DeclareMathOperator{\res}{Res}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\di}{div}
\DeclareMathOperator{\cha}{char}
\DeclareMathOperator{\gal}{Gal}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Ima}{Im}

%%% END Article customizations

%%% The "real" document content comes below...

\title{Group actions on de Rham cohomology of hyperelliptic curves}
\author{}
%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed

\begin{document}
\maketitle

\listoftodos

\todo[inline]{change references to preprint when in thesis}

\section{Serre duality}


We begin by recalling some of the details of Serre duality.
We take $X$ to be a smooth, projective, connected curve over an algebraically closed field $k$ of characteristic $P \geq 0$.
Furthermore, we let $G$ denote the automorphism group of $X$ and we let $K(X)$ denote the function field of $X$, and then let $\Omega_{K(X)}$ be the module of differentials of $K(X)$ over $k$.
The following lemma gives us a useful description of $H^1(X,\Omega_X)$.
\begin{lem}\label{exactsequencelemma}
The following sequence is exact:
\begin{equation}\label{dualityses}
0 \rightarrow \hzero \ra \Omega_{K(X)} \ra \bigoplus_{P \in X}\Omega_{K(X)}/\Omega_{X,P} \xrightarrow{\delta} H^1(X,\Omega_X) \ra 0.
\end{equation}
\end{lem}
\begin{rem}
Note that the sequence formed by the last three terms can be found in \cite[Pg. 248]{hart}.
\end{rem}
\begin{proof}
We let $\underline{\Omega}_{K(X)}$ be the constant sheaf of $\Omega_{K(X)}$.
Then the short exact sequence
\begin{equation}\label{serredualityses}
0 \rightarrow \Omega_X \rightarrow \underline{\Omega}_{K(X)} \rightarrow \underline{\Omega}_{K(X)}/\Omega_X \rightarrow 0
\end{equation}
is a flasque resolution of $\Omega_X$ by \cite[Chap II, ex. 1.16]{hart}.

We view the module $\Omega_{K(X)}/\Omega_{X,P}$ as a sheaf on the singleton $\{P\}$, which has a natural embedding $i\colon \{P\} \rightarrow X$.
Hence for each $P\in X$ we have the induced sheaf $i_*\left(\Omega_{K(X)}/\Omega_{X,P}\right)$ on $X$.
If we consider the direct sum of these induced sheaves over all points $P\in X$ we have the following isomorphism
\begin{equation}\label{sheafisomorphism}
\underline{\Omega}_{K(X)}/\Omega_X\cong \bigoplus_{P\in X} i_*\left(\Omega_{K(X)}/\Omega_{X,P}\right).
\end{equation}


To explain the isomorphism in \eqref{sheafisomorphism} we first construct a map from $\underline{\Omega}_{K(X)}/\Omega_{X,P}$ in to the product $\prod_{P \in X} i_*\left(\Omega_{K(X)}/\Omega_{X,P}\right)$, and then show that this map has finite support.

Given $i\colon \{P\} \hookrightarrow X$ we have the following equalities
\begin{align*}
i^{-1}\left(\underline{\Omega}_{K(X)}/\Omega_X\right) & = \left(\underline{\Omega}_{K(X)}/\Omega_X\right)_P \\
& = \underline{\Omega}_{K(X),P}/\Omega_{X,P} \\
& = \Omega_{K(X)}/\Omega_{X,P}.
\end{align*}
It follows that for each $P \in X$ we can map $f \in \underline{\Omega}_{K(X)}/\Omega_X$ to $i_*i^{-1}(f) \in i_8 \left( \Omega_{K(X)}/\Omega_{X,P} \right)$.
Recall that for any $f \in \Omega_{K(X)}$then $f$ lies in $\Omega_{X,P}$ for all but a finite number of points $P \in X$.
Hence the image of $f$ in $\prod_{P \in X} i_*\left(\Omega_{K(X)}/\Omega_{X,P}\right)$ is zero in almost all factors.
From this the isomorphism in \eqref{sheafisomorphism} follows.

Replacing $\underline{\Omega}_{K(X)}/\Omega_X$ by $\bigoplus_{P\in X} i_*\left(\Omega_{K(X)}/\Omega_{X,P}\right)$ in \eqref{serredualityses} and taking cohomology then yields the exact sequence in the statement of the lemma.\todo{repeated line earlier}
\end{proof}

For any $P\in X$ the residue map $\res_P \colon \Omega_{K(X)} \ra k$ is defined by the following properties:
\begin{itemize}
\item $\res_P(\omega) = 0$ for all $\omega \in \Omega_{P}$;
\item $\res_P(f^ndf) = 0$ for all $f \in K(X)^*$ and all $n \neq 1$;
\item $\res_P(f^{-1}df) = \ord_P(f)$, where $\ord_P(f)$ is the order of $f$ at $P$.
\end{itemize}
See \cite[Chap III, Thm. 7.14.1]{hart} for details.



Since $\Omega_P \subseteq \ker (\res_P)$, it follows that $\res_P$ is well defined on the quotient $\Omega_{K(X)}/\Omega_P$.
The residue theorem \cite[Chap. III, Thm. 7.14.2]{hart} states that $\sum_{P\in X} \res_P(\omega) = 0$ for any $\omega \in \Omega_{K(X)}$, and so the map 
\[
\bigoplus_{P \in X} \Omega_K(X)/\Omega_P \ra k, \quad (\omega_P)_{P \in X} \mapsto \sum_{P\in X} \res_P(\omega_P)
\]
vanishes on the image of $\Omega_{K(X)}$.
It follows that given some $\bar \omega$ in $H^1(X,\Omega_X)$, which is mapped to by some $(\omega_P)_{P \in X} \in \bigoplus_{P \in X} \Omega_K(X)/\Omega_P$, we can define the trace map $t$:
\[
t \colon H^1\left(X, \Omega_X\right) \ra k,\ \bar \omega \mapsto \sum_{P \in X} \res_P(\omega_P).
\]


We now use the trace map to define a pairing between the $k$-vector spaces $\hone$ and $\hzero$.
Roughly speaking, we can replace $\Omega_X$ by $\cO_X$ in Lemma \ref{exactsequencelemma} and get a similar result.
Hence $H^1(X,\cO_X)$ can also be viewed as a quotient of $\bigoplus_{P \in X} K(X)/\cO_{X,P}$.
Then we can define a map 
\begin{equation}\label{productmap}
\hzero \times \hone \ra H^1\left(X, \Omega_X\right), \ (\omega, \overline{(f_P)}_{P \in X}) \mapsto \overline {(f_P  \omega_P)}_{P \in X},
\end{equation}\todo{sort out notation}
where $f_p\omega_p$ is just the product of the germ of $\omega$ in $\Omega_{X,P}$ with $f_P$.
Note that in general we will denote elements of $\hone$ by $f$.

We now combine the product map in \eqref{productmap} with the trace map $t$ to get a map 
\[
 \hzero \times \hone \ra k,\quad (\omega, f) \to \langle \omega, f \rangle := t \left( f \omega \right).
\]

\begin{thm}\label{serredualitytheorem}
Via the pairing $\langle\ ,\ \rangle$, the $k$-vector spaces $\hone$ and $\hzero$ are dual to each other.
\end{thm}
\begin{proof}
This is a specialisation of \cite[Thm. 2, Chap. II]{algebraicgroupsandclassfields}.
\end{proof}

We briefly describe the maps Serre uses to prove the above theorem.
If we fix any $\omega \in \hzero$ we produce a map $\theta(\omega)\colon \hone \ra k$, given by $\theta(\omega)(f) = \langle \omega , f\rangle$.
Similarly, if we fix any $f \in \hone$ then we get a map $\psi(f) \colon \hzero \ra k$.
The maps $\psi$ and $\theta$ are isomorphisms and are dual to each other: in particular, this means that given a basis $e_1, \ldots, e_n$ of $\hzero$, we can find a basis $f_1, \ldots , f_n$ of $\hone$ such that $\theta(e_i)(f_i) = 1$ for all $1 \leq i \leq n$ and $\theta(e_i)(f_j) = 0$ if $i \neq j$ (and similarly for $\psi$).


\section{\cech cohomology}
In this section we describe $\hone$ and $\hzero$ concretely in terms of \cech cohomology.

By Leray's theorem \cite[Thm 5.2.12]{liu} and Serre's affineness criterion \cite[Thm 5.2.23]{liu} we know that the first \cech cohomology group of $\cO_X$ will be isomorphic to $\hone$ if the cover we use to compute the \cech cohomology is affine.
We let $U_a = X \backslash \pi^{-1}(a)$ for any $a \in \mathbb P_k^1$ and we let ${\cal U}$ be the affine cover of $X$ formed by $U_0$ and $U_\infty$.
Given any sheaf $\cal F$ on $X$ we have the \cech differential $\check{d}\colon {\cal F}(U_0) \times {\cal F} (U_\infty) \rightarrow {\cal F}(U_0 \cap U_\infty)$, defined by $(f_0,f_\infty) \mapsto f_0|_{U_0 \cap U_\infty} - f_\infty|_{U_0 \cap U_\infty}$.
In general we will suppress the notation denoting the restriction map.
Via this differential we have the following cochain complex
\begin{equation*}
0 \rightarrow \cO_X(U_0)\times \cO_X(U_\infty) \xrightarrow{\check{d}} \cO_X(U_0 \cap U_\infty) \rightarrow 0.
\end{equation*}
The first cohomology group of this chain is $\cechhone = \frac{\cO_X(U_0 \cap U_\infty)}{\Ima(\check{d})}$ and hence
\begin{equation}\label{cechhone}
\hone \cong \frac{\cO_X(U_0 \cap U_\infty)}{\Ima(\check{d})}  
 = \frac{\cO_X(U_0 \cap U_\infty)}{\{f_0 - f_\infty | f_i \in \cO_X(U_i) \}}.
\end{equation}

If we replace $\cO_X$ by $\Omega_X$ in the previous paragraph then everything still holds, and we can conclude that
\[
H^1(X,\Omega_X) \cong \frac{\Omega_X(U_0 \cap U_\infty)}{\Ima(\check{d})} = \frac{\Omega_X(U_0 \cap U_\infty)}{\{\omega_0 - \omega_ \infty | \omega_i \in \Omega_X(U_i)\}}.
\]\todo{check that I actually want this and $\hzero$}

We now describe the trace map using the \cech cohomology representative of $\hone$ above.
\begin{lem}\label{tracemaplemma}
For any $\bar \omega \in \check{H}^1\left (\cal U, \Omega_X\right )$, which has $\omega \in \Omega_X(U_0 \cap U_\infty)$ as a representative, we have the following equality:
\[
t(\bar \omega) = \sum_{P \in \pi^{-1}(\infty)}\res_P(\omega).
\]
\end{lem}
\begin{proof}
We take the \cech complex of \eqref{serredualityses} (replacing $\underline{\Omega}_{K(X)}/\Omega_X$ by $\bigoplus_{P \in X}\Omega_{K(X)}/\Omega_{X,P}$) over the cover $\cU$, yielding the following bicomplex
\begin{equation}\label{dualitydiagram2}
\xymatrix{\Omega_X(U_0)\times\Omega_X(U_\infty) \ar@{^{(}->}[r] \ar[d]^{d_1} & \underline{\Omega}_{K(X)} \times \underline{\Omega}_{K(X)} \ar[d]^{d_2} \ar@{->>}[r] & \bigoplus \limits_{P \in U_0} \Omega_{K(X)}/\Omega_{X,P} \times \bigoplus \limits_{P \in U_\infty} \Omega_{K(X)}/\Omega_{X,P} \ar[d]^{d_3} \\
\Omega_X(U_0 \cap U_\infty) \ar@{^{(}->}[r]  & \underline{\Omega}_{K(X)} \ar@{->>}[r] & \bigoplus \limits_{P\in U_0 \cap U_\infty} \Omega_{K(X)}/\Omega_{X,P} }
\end{equation}
We can now apply the snake lemma to this commutative diagram.
This gives rise to six terms, the last two of which are zero.
The other four terms are described below.

The fact that $H^0(X,\Omega_X) \cong \ker(d_1)$ and $H^1(X,\Omega_X) \cong {\rm coker}(d_1)$ follows from the above discussion of \cech cohomology.
The map $d_2\colon \Omega_{K(X)} \times \Omega_{K(X)} \ra \Omega_{K(X)}$ is the \cech differential given by $(\omega_1,\omega_2) \mapsto \omega_1 - \omega_2$.
Hence the map $\omega \mapsto (\omega, \omega)$ gives an isomorphism from $\Omega_{K(X)}$ to $\ker(d_2)$.
Finally, $d_3$ is defined by $(\omega_0, \omega_\infty) \mapsto \omega_0|_{U_0 \cap U_\infty} - \omega_\infty|_{U_0 \cap U_\infty}$.
Hence the kernel of $d_3$ is formed of pairs $(\omega_0, \omega_\infty) \in \bigoplus_{P \in U_0} \Omega_{K(X)}/\Omega_{X,P} \times \bigoplus_{P \in  U_\infty} \Omega_{K(X)}/\Omega_{X,P}$ such that $\omega_0$ and $\omega_\infty$ agree on $U_0 \cap U_\infty$.
It follows that the map 
\[
\bigoplus_{P \in X} \Omega_{K(X)}/\Omega_{X,P}\ra\ker(d_3), \quad  (\omega_P)_{P \in X} \to \left( (\omega_P)_{ P \in U_0}, (\omega_P)_{P \in U_\infty}) \right)
\]
is an isomorphism.

The proof now follows from a diagram chase on \eqref{dualitydiagram2}.
 We have a cocycle in $\bar \omega \in \hone$ with representative $\omega \in \Omega_X(U_0 \cap U_\infty)$.
This then injects in to $\underline{\Omega}_{K(X)}$, and since $d_2$ is surjective we can choose an element of $\underline{\Omega}_{K(X)} \times \underline{\Omega}_{K(X)}$ mapping to $\omega$.
In particular, we could choose $(\omega,0)$.
This then maps to 
\[
\psi = ((\bar{\omega}|_P)_{P\in U_0}, 0) \in \left( \bigoplus_{P \in U_0} \Omega_{K(X)}/\Omega_{X,P}\right) \times \left( \bigoplus_{P \in U_\infty} \Omega_{K(X)}/\Omega_{X,P} \right).
\]
By commutativity of the diagram $\psi \in \ker(d_3)$.
Since $\res_P(\omega)=0$ for all $P \in U_0 \cap U_\infty$, and similarly $\res_P(0)=0$ for all $P \in U_\infty$, then $\res_P(\psi) = 0$ for all $P \in U_\infty$.
Finally, we conclude that 
\[
t(\bar \omega) = \sum_{P \in X}\res_P(\bar \omega) = \sum_{P \in \pi^{-1}(\infty)} \res_P(\bar \omega) = \sum_{P \in \pi^{-1}(\infty)} \res_P(\omega).
\]
\end{proof}

We now recall how to compute the algebraic de Rham cohomology of $X$ via \cech cohomology.
Since $X$ is a curve any differentials of degree greater than one on $X$ are zero.
Hence the de Rham complex of $X$ is the hypercohomology of the complex
\begin{equation}\label{res}
0 \rightarrow \cO_X \xrightarrow{d} \Omega_X \rightarrow 0.
\end{equation}
Here $d$ denotes the differential map $f \mapsto df$, as defined in \cite[Chap II, \S 8, Pg. 172]{hart}.

We use the cover $\cal U$ and the \cech differentials as defined earlier to give us the \cech bicomplex of \eqref{res}, which is
\begin{equation}\label{bicomplex}
\xymatrix{ & 0 \ar[d] & 0 \ar[d] & \\
0 \ar[r] & \cO_X(U_0) \times \cO_X(U_\infty) \ar[d] \ar[r] & \Omega_X(U_0) \times \Omega_X(U_\infty) \ar[d] \ar[r] & 0 \\
0 \ar[r] & \cO_X(U_0\cap U_\infty) \ar[d] \ar[r] & \Omega_X(U_0 \cap U_\infty) \ar[r] \ar[d] & 0 \\
& 0 & 0 &}
\end{equation}
By a generalisation of Leray's theorem \cite[Cor 12.4.7]{EGA0III} we know that the $\derhamhone$ is isomorphic to the first cohomology of the total complex of \eqref{bicomplex}.
Note that this requires ${\check H}^p(U_\sigma, \cO_X)$ and ${\check H}^p(U_\sigma, \Omega_X)$ to be zero for any $\sigma$ in the nerve of $\cU$ and any $p \geq 1$ ---
since $U_0$ and $U_\infty$ are affine, this again follows from Serre's affineness criterion \cite[Thm 5.2.23]{liu}.



After computing the first cohomology group of the total complex of \eqref{bicomplex} we see that $\derhamhone$ is isomorphic to the space
\begin{equation}\label{derhamconditions}
\left\{(\omega_0, \omega_\infty, f_{0,\infty}) | \omega_i\in \Omega_{X/k}(U_i), f_{0,\infty}\in \cO_X(U_0 \cap U_\infty), df_{0,\infty} = \omega_0|_{U_0\cap U_\infty} - \omega_\infty|_{U_0\cap U_\infty} \right\}
\end{equation}
quotiented by the subspace
\begin{equation}\label{quotient}
\left\{  (df_0, df_\infty, f_0|_{U_0\cap U_\infty} -f_\infty|_{U_0\cap U_\infty} )|f_i \in \cO_X(U_i)\right\}.
\end{equation}

We wish to compute a $k$-basis of $\derhamhone$ in order that we can see how $G$ acts on $\derhamhone$ and to study the $k[G]$-module structure.
The following lemma shows that $\derhamhone$ fits in to a short exact sequence which we will use to compute the $k$-basis.
\begin{prop}\label{ses}
The following is a short exact sequence
\begin{equation}\label{equationses}
0 \ra H^0(X,\Omega_X) \xrightarrow{i} \derhamhone \xrightarrow{p} H^1(X,\cO_X) \ra 0, 
\end{equation}
where $i \colon \omega \mapsto (\omega, \omega)$ and $p \colon (\omega_0, \omega_\infty, f_{0 \infty}) \to f_{0 \infty}$.
\end{prop}
\begin{proof}
Let $T$ be the total complex of \eqref{bicomplex}.
Moreover, we let $\cO$ and $\Omega$ be the complexes formed from the first and second (non-trivial) columns of \eqref{bicomplex} respectively.
Then let $\Omega[1]$ denote the complex obtained from shifting $\Omega$ by one, i.e. $\Omega[1]^{n+1} = \Omega^n$.
Then we obtain the following short exact sequence of complexes 
\[
\Omega[1] \hookrightarrow T \twoheadrightarrow \cO,
\]
giving rise to the following long exact sequence
\begin{equation*}
0 \ra H^0_{\text {dR}}(X/k) \ra H^0(X,\cO_X) \ra \\
\end{equation*}
\begin{equation}\label{longexactsequence}
 H^0(X,\Omega_X) \ra \derhamhone \ra \hone \ra \\
\end{equation}
\begin{equation*}
 H^1(X,\Omega_X) \ra H^2_{\text {dR}}(X/k) \ra 0.
\end{equation*}
The map $H^0(X,\cO_X) \ra \hzero$ is the map $f \mapsto df$.
Since the only globally holomorphic functions on $X$ are constant functions, it follows that this is the zero map, and hence $\hzero \ra \derhamhone$ is injective.

Since \eqref{longexactsequence} is exact, $p$ is surjective if and only if $\alpha \colon H^1(X,\Omega_X) \ra H^2_{\text {dR}}(X/k)$ is injective.
Now $H^1(X,\Omega_X)$ is isomorphic to $k$ via the residue map \cite[Chap. III, Thm. 7.14.1]{hart}, and if we can show that this isomorphism factors through $\alpha$ it will follow that $\alpha$ is injective.
Considering the \cech cohomology constructions of $H^1(X,\Omega_X)$ and $H^2_{\text {dR}}(X/k)$, it suffices to show that the residue map is zero on $\Ima \left( d \colon \cO_X(U_0 \cap U_\infty) \ra \Omega_X(U_0 \cap U_\infty) \right)$.
This follows from \cite[Chap. III, Thm. 7.14.1 (b)]{hart}, which says that $\res_P(df)=0$ for any $f \in \cO_X(U_0 \cap U_\infty)$.
Hence the residue isomorphism factors through $\alpha$, and hence $p$ is surjective.
\end{proof}

\section{Basis of $\hone$ and $\derhamhone$}

Let $X$ be a smooth, projective, connected hyperelliptic curve of genus $g \geq 2$ over an algebraically closed field $k$ of characteristic $p \geq 0$.
We  fix a map $\pi \colon X \rightarrow \mathbb P_k^1$ of degree two, which is unique up to an automorphism of $\mathbb P_k^1$.
We let $G$ denote a finite group acting faithfully on $X$.

We now give an explicit basis of $\hone$ and $\derhamhone$, in terms of $f(x)$ and its coefficients.
We use the results of the previous sections along with methods similar to those found in \cite{canonicalrepresentation} to achieve this.

If $p \neq 2$ then the extension $K(X)$ of $K(\mathbb P_k^1) = k(x)$ will be $k(x,y)$ where $y$ satisfies
\begin{equation}\label{definingequationpnot2}
y^2 = f(x)
\end{equation}
for some polynomial $f(x) \in k[x]$ which has no repeated roots and is of degree $2g+1$ or $2g+2$ \cite[Prop 7.4.24]{liu}.
On the other hand, if $p=2$, then the extension $K(X)$ of $k(x)$ will be $k(x,y)$, this time with $y$ satisfying the equation
\begin{equation}\label{definep=2}
y^2 - H(x)y = F(x)
\end{equation}
for some $H(x),F(x) \in k[x]$, such that $H(x)$ and $H'(x)^2F(x) + F'(x)^2$ share no roots.
We require that $\deg(H(x)) \leq g+1$, with equality if and only if $\infty$ is not a branch point, and that $\deg(F(x)) \leq 2g+2$ with $\deg(F(x)) = 2g+1$ if $\infty$ is a branch point  \cite[Prop 7.4.24]{liu}.

We now recall the details of some divisors discussed in \cite{faithfulaction}, which we will need later.
Henceforth we let $P_a$ and $P_a'$ denote the unique elements of $\pi^{-1}(a)$ for any point $a \in \mathbb P_k^1$ that is not a branch point.
If $a \in \mathbb P_k^1$ is a branch point we denote the unique point in $\pi^{-1}(a)$ by $P_a$.
We also define $D_a$ to be the divisor $\pi^*\left([a]\right)$ for any $a \in \mathbb P_k^1$, and hence
\begin{equation*}
D_a= 
\begin{cases}
 2[P_a] & \text{if $a$ is a branch point}, \\
 [P_a] + [P_a'] & \text{otherwise.}
\end{cases}
\end{equation*}

If $p \neq 2$ then the ramification points are the zeroes of $f(x)$.
We suppose that 
\[
f(x) = \prod_{i=1}^{d_f} (x-a_i) = x^{d_f} + b_{d_f - 1}x^{d_f-1} \ldots + b_0,
\]
for some $a_i, b_i \in k$, $d_f = \deg(f) $ and $n_i \mathbb N$.
In this case, the $a_i \in \mathbb A_k^1 \subset \mathbb P_k^1$ are the branch points of $\pi$, and hence we let $P_i = P_{a_i}$ denote the corresponding ramification points.
Then the ramification divisor $R$ of $\pi$ is
\[
R = \sum_{i=1}^{d_f} [P_i].
\]\todo{what to do about $\infty$?}
If $p=2$ then we suppose that
\begin{equation*}
H(x) = \prod_{i=1}^{d_H} (x-A_i)^{n_i} = x^{d_H} + B_{{d_H}-1}x^{{d_H}-1} + \ldots + B_1x + B_0
\end{equation*}
for some $A_i, B_i \in  k$, ${d_H} \leq g+1$ and $n_i \in \mathbb N$.
Then, as above, the $A_i$ are the branch points of $\pi$ and we let $P_i \in X$ be the corresponding ramification points.
Given this, we can write the ramification divisor as
\[
R = \sum_{i=1}^{d_H} 2n_i[P_i] + (g+1-{d_H})D_\infty.
\]


We also have
\begin{equation}\label{divxp=2}
\di (x)  = D_0 - D_\infty
\end{equation}
and
\begin{equation}\label{differentialdivisor}
\di(dx) = R - 2D_\infty,
\end{equation}
This is again regardless of characteristic.

If $p \neq 2$ then 
\begin{equation}\label{pnot2divisors}
\di(y)  = R - (g+1)D_\infty.
\end{equation}
whilst if $p=2$ then the divisor of $H(x)$ is
\begin{equation}\label{divisorofH}
\di (H(x))  = R - (g+1)D_\infty. 
\end{equation}
We also compute the divisor of $dy$ when the characteristic of $k$ is $2$.
We start by noting that when we take the differential of \eqref{definep=2} we obtain
\[
dF = d\left(y^2 + yH \right) = d(yH) = Hdy + ydH
\]
and from this it follows that
\begin{equation}\label{divdyp=2}
dy = \frac{F'-yH'}{H}dx.
\end{equation}

Finally, we describe the divisor of $y$ when $p=2$.
In order to do this we need to distinguish the zeroes of $F(x)$.
Suppose that $F(x)$ has $l \leq \deg(F)$ distinct zeroes, and let $\gamma_1, \ldots, \gamma_l \in k \subseteq \mathbb P_k^1$ be these zeroes.
Then if $\gamma_i$ is a branch point let $Q_i = (\gamma_i, 0)$ be the unique point in the pre-image $\pi^{-1}(\gamma_i)$.
If $\gamma_i$ is not a branch point then let $Q_i = (\gamma_i, 0)$ and $Q_i' = (\gamma_i, H(\gamma_i))$ be the unique points that form the pre-image $\pi^{-1}(\gamma_i)$.
Also, we denote the order of the zero of $F(x)$ at $\gamma_i \in k$ by $m_i$.


\begin{prop}\label{divyp=2}
Suppose that $p=2$.
Then, if $\infty$ is a branch point, the divisor of $y$ is
\begin{equation*}
\di(y) = 
 {\displaystyle \sum_{i=1}^l} m_i[Q_i] -(2g+1)[P_\infty].
\end{equation*}
On the other hand, if $\infty$ is not a branch point, then, after possibly swapping the notations for $P_\infty$ and $P_\infty'$ for the two points in $\pi^{-1}(\infty)$, we have
\begin{equation*}
 \di(y) = {\displaystyle \sum_{i=1}^l} m_i[Q_i] +(g+1-\deg(F(x)))[P_\infty] - (g+1)[P_\infty'].
\end{equation*}
\end{prop}
\begin{proof}
We first show that $\di_0(y)$, the divisor of the zeroes of $y$, is $\sum_{i=1}^l m_i [Q_i]$.

It is clear that the zeroes of $y$ can only occur in the affine part of the curve $X$ defined by \eqref{definep=2} i.e. in $U_\infty$.
Suppose $P\in U_\infty$.
If $\left. F \right|_P \neq 0$ then it follows that $y|_P \neq 0$, since $F(x) = y (y + H(x))$.
Hence $\di_0(y)$ has zero coefficients for any point in $U_\infty$ other than the $Q_i$.

Suppose that $P= Q_i = (\gamma_i, 0)$ is an unramified point in $U_\infty$.
Then $H(\gamma_i) \neq 0$ and $\left. y \right|_P = 0$, so $y + H(x)$ is a unit at $P$.
Since $y(y+H(x)) = F(x)$ we find that
\begin{equation*}
\ord_P(y) = \ord_P\left( \frac{F(x)}{y + H(x)} \right) = \ord_P(F(x)) = m_i.
\end{equation*}

We now look at when $P = Q_i = (\gamma_i, 0)$ is a ramification point.
Since $H(x)$ and $H'(x)^2F(x) + F'(x)^2$ cannot share roots it follows that $m_i = 1$.
Hence the function $\tilde F(x) := (x- \gamma_i)^{-1}F(x)$ is a unit at $P$.
We let $\tilde H(x) = (x- \gamma_i)^{-1}H(x)$.
Now $y^2 = F(x) - y H(x) = (x- \gamma_i) (\tilde F(x) - y \tilde H(x))$, and hence
\[
\ord_P(y^2 ) = \ord_P(x-\gamma_i) + \ord_P(\tilde F(x) - y \tilde H(x)).
\]
Since $\ord_P(x-\gamma_i) = 2$ and $\ord_P(\tilde F(x) - y \tilde H(x)) \geq 0$ we know that $\ord_P(y) \geq 1$.
Hence $\left. (y \tilde H(x)) \right|_P = 0$, and since $\tilde F(x)$ is a unit at $P$, we conclude that $\tilde F(x) - y \tilde H(x)$ is a unit at $P$.
Hence $\ord_P(y^2) = 2$, and so $\ord_P(y) = 1 = m_i$.
It follows that $\di_0(y) =  \sum_{i=1}^l m_i [Q_i]$.

We now consider the poles of $y$.
If $\infty$ is a branch point we know that $\deg(F(x)) = 2g+1$ and hence $\sum_{i=1}^l m_i = 2g+1$.
Since $y$ can only have a pole at $P_\infty$, we conclude that the degree of this pole is $2g+1$, and hence
\[
\di(y) = \sum_{i=1}^l m_i [Q_i] - (2g+1)[P_\infty]
\]
if $\infty$ is a branch point.

If $\infty$ is not a branch point then there are two points at which $y$ may have a pole, namely $P_\infty$ and $P_\infty'$.
We consider three cases, and recalling that $\ord_{P_\infty}(y + H(x)) = \ord_{P_\infty'}(y)$, using the automorphism given by $y \mapsto y+H(x)$.


Firstly, we suppose that $\ord_{P_\infty}(y) < -(g+1)$.
Then $\ord_{P_\infty}(y) < \ord_{P_\infty}(H(x))$ and hence $ \ord_{P_\infty}(y) = \ord_{P_\infty}(y+H(x))$.
But this contradicts $\ord_{P_\infty}(y) + \ord_{P_\infty}(y+H(x)) = \ord_{P_\infty}(F(x))$, since the left hand side is less than $-2(g+1)$, which is the minimum value of the right hand side.

We now suppose that $\ord_{P_\infty} (y) = -(g+1)$. Since $y(y+H(x)) = F(x)$ it follows that $-(g+1) + \ord_{P_\infty}(y+H(x)) = \ord_{P_\infty}(F(x))$, and hence $\ord_{P_\infty'}(y) = \ord_{P_\infty}(y+H(x)) = -\deg(F(x)) + g + 1$.

Finally, if $\ord_{P_\infty}(y) > -(g+1)$, then since $\ord_{P_\infty}(H(x)) = -(g+1)$ it follows that $\ord_{P_\infty'}(y) = \ord_{P_\infty} (y+H(x)) = -(g+1)$.
Then, from a computation similar to that in the previous paragraph we see that $\ord_{P_\infty}(y) = -\deg(F(x)) + g +1$, completing the proof.
\end{proof}

\begin{prop}\label{basish1}
 Via the isomorphism \eqref{cechhone} the residue classes of $\frac{y}{x}, \ldots , \frac{y}{x^g} \in K(X)$, restricted to $U_0 \cap U_\infty$, form a basis of $H^1(X,\cO_X)$.
\end{prop}
\begin{proof}
We start by considering the case $p \neq 2$ and first check that the functions $\frac{y}{x}, \ldots, \frac{y}{x^g}$ are indeed regular on $U_0 \cap U_\infty$ (as required by \eqref{cechhone}) by computing their divisors.
From \eqref{divxp=2} and \eqref{pnot2divisors} we see that
\begin{align}\label{divisorofyoverx}
\di \left( \frac{y}{x^i} \right) & = \di (y) - \di ( x^i) \nonumber \\
& = R - (g+1)D_\infty - iD_0 + iD_\infty \nonumber \\
& = R - iD_0 - (g+1 - i)D_\infty.
\end{align}
Since $R$ is a positive divisor this is non-negative on $U_0 \cap U_\infty$ if $i\in \{0, \ldots, g-1\}$.


Recall that the differentials $\omega_0 = y^{-1}dx, \ldots, \omega_{g-1} = x^{g-1}y^{-1}dx$ form a basis of $\hzero$ (see, for example, \cite[Chap 7, Prop. 4.26]{liu}).
By Lemma \ref{tracemaplemma} we know that $\langle x^iy^{-1}dx, yx^{-j} \rangle = \sum_{P \in \pi^{-1}(\infty)}\res_P(x^{i-j}dx)$.
It follows immediately from \cite[Chap. III, Thm. 7.14.1(b)]{hart} that $\sum_{P \in \pi^{-1}(\infty)}\res_P(x^{i-j}dx) = -2$ if and is zero otherwise.
It then follows from Theorem \ref{serredualitytheorem} that the collection of elements $\{ yx^{-j}|_{U_0\cap U_\infty}\}_{ 1 \leq j \leq g}$ form a basis of $\hone$.



We now suppose that $p=2$, and again start by checking that for $i \in \{1, \ldots , g\}$ the function $yx^{-i}$ is regular on $U_0 \cap U_\infty$.
This follows once we compute the divisor of $yx^{-i}$, which is
\begin{equation*}
\di \left( \frac{y}{x^i} \right)  =  
{\displaystyle \sum_{i=1}^l} m_i[Q_i] -iD_0 -(2g+1 - 2i)[P_\infty]
\end{equation*}
if $\infty$ is a branch point and
\begin{equation*}
\di \left( \frac{y}{x^i} \right)  =  
{\displaystyle \sum_{i=1}^l} m_i[Q_i] - iD_0 +(g+1-\deg(F(x)) + i)[P_\infty] - (g+1-i)[P_\infty']
\end{equation*}
otherwise.
These equalities follow from Proposition \ref{divyp=2} and \eqref{divxp=2}.
The divisors are clearly positive on $U_0 \cap U_\infty$.

Next we recall from \cite[Chap 7, Prop. 4.26]{liu} that if $p=2$ a basis of $\hzero$ is given by $\frac{1}{H(x)}dx, \ldots, \frac{x^{g-1}}{H(x)}dx$.
We then deduce from Lemma \ref{tracemaplemma} that
\[
\left \langle \frac{x^i}{H(x)}dx, \frac{y}{x^j} \right \rangle = \res_{P_\infty} \left( \frac{yx^{i-j}}{H(x)}dx \right) + \res_{P_\infty'}\left( \frac{yx^{i-j}}{H(x)} dx \right).
\]
Then recall that in characteristic two we have an involution $\sigma \colon X \ra X$ given by $(x,y) \mapsto (x, y + H(x))$, and that $\res_P(\sigma^*(\omega)) = \res_{\sigma(P)}(\omega)$ for any $P \in X$ and $\omega\in \hzero$.
Then it follows that
\begin{align*}
\sum_{P \in \pi^{-1}(\infty)} \res_P \left( \frac{yx^{i-j}}{H(x)}dx \right) & = \res_{P_\infty} \left( \frac{yx^{i-j}}{H(x)} dx \right) + \res_{P_\infty'}\left( \frac{yx^{i-j}}{H(x)} dx\right) \\
& = \res_{P_ \infty} \left( \frac{yx^{i-j}}{H(x)}dx \right) + \res_{P_ \infty} \left( \frac{(y+H(x))x^{i-j}}{H(x)}dx \right) \\
& = \res_{P_\infty}(x^{i-j}dx),
\end{align*}
since we are assuming that $\cha(k) = 2$.
As in the previous case, it then follows from the definition of $\res_P$ that $\res_{P_\infty}(x^{i-j}dx) = -1$ if $i-j = -1$ and is zero otherwise.



If $P_\infty$ is a branch point then we start by computing the divisor of $ \frac{y}{x^j} \cdot \frac{x^i}{H(x)}dx$, using \eqref{divxp=2}, \eqref{differentialdivisor}, \eqref{divisorofH} and Proposition \ref{divyp=2}:
\begin{align*}
\di\left( \frac{yx^{i-j}}{H(x)}dx \right) & = \di(y) + \di(x^{i-j}) + \di( dx) - \di(H(x)) \\
& = \sum_{i=1}^l m_i[Q_i] - (2g+ 1 )[P_\infty] + (i-j)D_0 - (i-j)D_\infty + R - 2D_\infty \\
& \qquad - R + (g+1)D_\infty\\
& = \sum_{i=1}^l m_i[Q_i] + (2j-3-2i)[P_\infty] + (i-j)D_0
\end{align*}
We see that there is a pole of order one at $P_\infty$ if $2j - 3 - 2i = -1$, or equivalently if $j = i+1$.
Hence $\langle \frac{x^i}{H(x)}dx, \frac{y}{x^j} \rangle \neq 0$ in this case.\todo{what is the residue?}

We also need to check that if $j \neq i+1$ then $\left \langle \frac{x^i}{H(x)}dx, \frac{y}{x^j} \right \rangle = 0$.
Indeed, if $j-i \geq 2$ then clearly $\frac{yx^{i-j}}{H(x)}dx$ does not have a pole at $P_\infty$.
On the other hand, if $j-i \leq 0$ then the differential $\frac{yx^{i-j}}{H(x)}dx$ is regular on $U_\infty$, and hence the residue on this set is zero.
Since $X \backslash U_\infty = \{P_\infty\}$ it follows from the residue theorem the residue of $\frac{yx^{i-j}}{H(x)}dx$ at $P_\infty$ is also zero.
\end{proof}

%Mittag-Leffler style corollary
\begin{cor}
For each $P \in X$ fix some $f_P \in K(X)$, such that $f_P = 0$ for almost all $P$.
Then there exist unique $\alpha_1, \ldots , \alpha_g \in k$ such that, after $f_P$ is replaced by $f_P~-~\left(\alpha_1 \frac{y}{x} + \ldots + \alpha_g \frac{y}{x^g} \right)$ for all $P \in \pi^{-1}(\infty)$, there exists an $f \in K(X)$ such that the laurent tail of $f$ at each $P$ in $X$ will be $f_P$.
\end{cor}
\todo[inline]{Do $\alpha_i$ depend on $P$? Rephrase first line to start "let $P_1, \ldots, P_n$ be a finite collection of points..."}
\begin{proof}

\end{proof}


In order to state a basis of $\derhamhone$, as well as to shorten the proof of the following theorem, we define the following polynomials. 
We suppose that $1 \leq i \leq g$.
Then when $p\neq 2$ we define
\[
s_i(x) := xf'(x) - 2if(x) \in k[x]
\]
and when $p = 2$ we define
\begin{equation}\label{capitals}
S_i(x,y) := xF'(x) + y(xH'(x) + iH(x))\in k[x]\oplus yk[x] \subseteq k(x,y).
\end{equation}

We now decompose these polynomials into two parts, which will be used in the sequel.
Firstly, we write $s_i(x)$ as $s_i(x) = \phi_i(x) + \psi_i(x)$, where $\psi_i(x)\in k(x)$ and $\phi_i(x) \in k[x]$ are the unique polynomials such that the degree of $\psi_i (x)$ is at most $g+1$ and $x^{g+2}$ divides $\phi_i(x)$.

We define $A_{j,i} \in k$ for $1 \leq j \leq 2g+2$, and $B_{k,i} \in k$ for $0\leq k \leq g+1$ by the equation
\[
S_i(x,y) = A_{2g+2,i}x^{2g+2} + \ldots + A_{1,i} x + y(B_{g+1,i} x^{g+1} + \ldots + B_{1,i} x + B_{0,i}).
\]
Note that many of these coefficients may be zero.
In particular we remark that the $x^i$ term of $xH'(x) + iH(x)$, and hence $B_{i,i}$, is always zero, since it is precisely $x \cdot b_ix^{i-1} + b_i x^i = 2B_{i,i}x^i = 0$.\todo{move back to where it previously was}


We now define the following polynomials:
\begin{equation}\label{Split}
\begin{split}
\Phi_i^x(x) & =  {}_iA_{2g+2}x^{2g+2} + \ldots + {}_iA_{i+1}x^{i+1} \\
\Psi_i^x(x) & =  {}_iA_ix^i + \ldots + {}_iA_1x \\
\Phi_i^y(x) & =  {}_iB_gx^g + \ldots {}_iB_{i+1}x^{i+1} \\
\Psi_i^y(x) & =  {}_iB_{i-1}x^{i-1} + \ldots + {}_iB_1x + {}_iB_0.
\end{split}
\end{equation}
Finally, we define $\Phi_i(x,y) = \Phi_i^x(x) + y \Phi^y_i(x)$ and $\Psi_i(x,y) = \Psi_i^x(x) + y \Psi_i^y(x)$, so that $S_i(x,y) = \phi_i(x,y) + \psi_i(x,y)$.

Viewing $\derhamhone$ as a quotient of \eqref{derhamconditions}, we now give a $k$-vector space basis of $\derhamhone$.
\begin{thm}\label{basis}

If $p \neq 2$ then the residue classes of 
\begin{equation}\label{one}
 \left( \left( \frac{\psi_i(x)}{2yx^{i+1}}\right) dx, \left(\frac{-\phi_i(x)}{2yx^{i+1}}\right) dx, x^{-i}y\right), i=1, \ldots ,g,
\end{equation}
along with the residue classes of 
\begin{equation}\label{two}
 \left( \frac{x^{i}}{y} dx , \frac{x^{i}}{y} dx, 0 \right), i = 0,\ldots ,g-1,
\end{equation}
form a basis of $\derhamhone$.

On the other hand, if $p=2$ then the residue classes of the elements 
\begin{equation}\label{three}
\left( \left(\frac{\Psi_i(x,y)}{x^{i+1}H(x)}\right) dx, \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} \right) dx, x^{-i}y \right), i =1, \ldots , g,
\end{equation}
together with the residue classes of 
\begin{equation}\label{four}
\left( \frac{x^{i}}{H(x)} dx, \frac{x^{i}}{H(x)} dx, 0 \right), i=0, \ldots, g-1,
\end{equation}
form a basis of $\derhamhone$.
\end{thm}

Before proving this theorem we use it to prove the following corollary.

\begin{cor}
The action of $G$ on $\derhamhone$ is faithful unless $G$ contains a hyperelliptic involution and $p=2$, in which case the action of the hyperelliptic involution is trivial.
\end{cor}

\begin{proof}
Recall from Proposition \ref{ses} that $H^0(X,\Omega_X)$ injects into $\derhamhone$.
Then if $p \neq 2$ or $G$ does not contain a hyperelliptic involution it follows from \cite[Thm. 4.2]{faithfulaction} that $G$ acts faithfully on $H^0(X,\Omega_X)$, and hence $G$ acts faithfully on $\derhamhone$.

We now suppose that $p=2$ and that $G$ contains a hyperelliptic involution, which we denote by $\sigma$.
By the same theorem from \cite{faithfulaction} as used in the last paragraph, we know that $\sigma$ acts trivially on $\hzero$.

Since $\hzero$ is dual to $\hone$ we know that $\sigma$ acts trivially on $\hone$.
We can study exactly why this is from the view of \cech cohomology, and this will also help to determine the action of $\sigma$ on $\derhamhone$.
If we fix a natural number $i\in \{1, \ldots ,g\}$ then $\sigma$ maps $\frac{y}{x^i}$ to $\frac{y}{x^i} + \frac{H(x)}{x^i}$. 
Now we can split $\frac{H(x)}{x^i}$ as follows, 
\begin{equation*}
\frac{H(x)}{x^i} =  \frac{b_{i-1}x^{i-1} + \ldots + b_1x + b_0}{x^i} - \left( - \frac{x^d + b_{d-1}x^{d-1} + \ldots + b_ix^i}{x^i} \right),
\end{equation*}
and since this is clearly the difference of an element of $\cO_X(U_0)$ and an element of $\cO_X(U_\infty)$ we see that $\frac{H(x)}{x^i}$ is zero in $\hone$.
We let 
\[
H_{1,i}(x) = b_{i-1}x^{i-1} + \ldots + b_1x + b_0
\]
and 
\[
H_{2,i}(x) = -( x^d + b_{d-1}x^{d-1} + \ldots + b_ix^i).
\]

We now consider the action of $\sigma$ on the entries in \eqref{three}.
Firstly we see that
\begin{align*}
\sigma \left( \frac{-\Psi_i(x,y)}{x^{i+1}H(x)} dx\right) & = \frac{-\sigma(\Psi_i(x,y))}{x^{i+1} H(x)} dx \\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)}dx + \frac{H(x)(xH_{1,i}'(x) + iH_{1,i}(x))}{x^{i+1}H(x)}dx\\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)}dx + \frac{xH_{1,i}'(x) + iH_{1,i}(x)}{x^{i+1}}dx \\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)}dx +  \frac{H_{1,i}'(x)}{x^i}dx + \frac{iH_{1,i}(x)}{x^{i+1}}dx \\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)}dx +  \frac{1}{x^i}d\left( H_{1,i}(x) \right) + H_{1,i}(x) d \left( \frac{1}{x^i} \right) \\
& = \frac{-\Psi_i(x,y)}{x^{i+1}H(x)}dx + d\left( \frac{H_{1,i}(x)}{x^i} \right),
\end{align*}
where the second equality follows from \eqref{capitals} and the fact that $\sigma(y) = y + H(x)$.

Similarly we can derive
\begin{equation*}
\sigma \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} dx \right)  = \frac{\Phi_i(x,y)}{x^{i+1}H(x)} dx + d \left( \frac{H_{2,i}(x)}{x^i} \right).
\end{equation*}
Lastly, it is clear that $\sigma(x^{-i}y) = x^{-i}(y+H(x))$.


We can now describe exactly how sigma acts on the elements of \eqref{three} using $H_{1,i}(x)$ and $H_{2,i}(x)$:
\begin{multline*}
\sigma \left( \left( \left(\frac{-\Psi_i(x,y)}{x^{i+1}H(x)}\right) dx, \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} \right) dx, x^{-i}y \right)\right) = \\
 \left( \left(\frac{-\Psi_i(x,y)}{x^{i+1}H(x)} \right) dx + d\left(\frac{H_{1,i}(x)}{x^i}\right),  \left( \frac{\Phi_i(x,y)}{x^{i+1}H(x)} \right) dx+ d\left(\frac{H_{2,i}(x)}{x^i} \right), \frac{y+H(x)}{x^i} \right).
\end{multline*}
So the action of $\sigma$ on the basis elements in \eqref{three} amounts to adding 
\[
\left( d\left(\frac{H_{1,i}}{x^i}\right), d\left(\frac{H_{2,i}}{x^i}\right), \frac{H(x)}{x^i} \right),
\]
which clearly satisfies the conditions of \eqref{quotient} and hence is zero.
So the action of the involution $\sigma$ on $\derhamhone$ is trivial and hence the action of the group $G$ is not faithful.
\end{proof}

\begin{rem}
We briefly study the action of $\sigma$ on the elements \eqref{one} (when $p\neq 2$).
When $p \neq 2$ then $\sigma$ acts by $(x,y) \mapsto (x,-y)$.
If we let
\[
\nu_i = \left( \left( \frac{\psi_i(x)}{2yx^{i+1}}\right) dx, \left(\frac{-\phi_i(x)}{2yx^{i+1}}\right) dx, x^{-i}y\right)
\]
then 
\begin{equation*}
\sigma(\nu_i) = -\nu_i.
\end{equation*}
Similarly, if 
\[
\eta_i = \left( \frac{x^i}{y}dx, \frac{x^i}{y}dx, 0 \right)
\]
then 
\[
\sigma(\eta_i) = - \eta_i.
\]
Hence $\sigma$ acts by multiplication with $-1$ on $\derhamhone$.
\end{rem}


We now prove Theorem \ref{basis}.

\begin{proof}
We make use of the fact that the short exact sequence in Lemma \ref{ses} splits as a sequence of vector spaces over $k$, and that we know bases of the outer two terms.

It is clear that the elements in \eqref{two} and \eqref{four} are elements of the space \eqref{derhamconditions}. 
In fact, it follows from \cite[Thm 6.1]{faithfulaction} that they are the image of a basis of $H^0(X,\Omega_X)$ in $\derhamhone$.

Moreover, it is obvious that if the elements in \eqref{one} and \eqref{three} are well defined elements of the space \eqref{derhamconditions} then they will map to the basis of $\hone$ given in Lemma \ref{basish1}.
So we need only show that the terms in \eqref{one} and \eqref{three} satisfy the conditions stated in \eqref{derhamconditions}.
For the rest of the proof we fix $i \in \{1, \ldots ,g\}$.


We start with the case $p\neq 2$, and observe that
\begin{align*}
\left(  \frac{\psi_i(x)}{2yx^{i+1}}  - \frac{-\phi_i(x)}{2yx^{i+1}} \right) dx & =  \frac{s_i(x)}{2yx^{i+1}} dx \\
& =  \frac{1}{2yx^i} \left( f' - \frac{2if}{x} \right) dx \\
& =  \frac{x^i}{2y} \left( \frac{f'}{x^{2i}}dx -\frac{2if}{x^{2i+1}} dx \right) \\
& =  \frac{x^i}{2y} \left( fd\left(\frac{1}{x^{2i}}\right) + \frac{1}{x^{2i}}df \right) \\
& =  \frac{x^i}{2y}d(fx^{-2i}) \\
& =  \frac{x^i}{2y} d\left(\left(yx^{-i}\right)^2\right) \\
& =  d(yx^{-i}),
\end{align*}
with the penultimate line following from the defining equation \eqref{definingequationpnot2}.
This shows that the elements in \eqref{one} satisfy $df_{0, \infty} = \omega_0 - \omega_\infty$, one of the conditions of \eqref{derhamconditions}.
Since we saw in the proof of Lemma \ref{basish1} that $\frac{y}{x^i}$ is regular on $U_0\cap U_\infty$ it only remains to show that $\frac{\phi_i}{2yx^{i+1}}dx$ and $\frac{-\psi_i}{2yx^{i+1}}dx$ are regular on $U_\infty$ and $U_0$ respectively.


In order to do this we define $\alpha_{j,i} \in k$ for $0\leq j \leq 2g+2$ to satisfy the equation
\[
s_i(x) = \alpha_{2g+2,i}x^{2g+2} + \ldots + \alpha_{0,i},
\]
so that
\[
\phi_i(x) = \alpha_{2g+2,i}x^{2g+2} + \ldots + \alpha_{g+2,i}x^{g+2} \ {\rm and } \ \psi_i(x) = \alpha_{g+1,i}x^{g+1} + \ldots + \alpha_{0,i}.
\]
Note that it is possible for any of $\alpha_{j,i}$ to be zero. In fact, it is possible for either $\phi_i(x)$ or $\psi_i(x)$ to be zero.
Whenever they are non-zero we denote their degrees as polynomials in $x$ by $d_\phi$ and $d_\psi$ respectively. From the definition of $\phi_i(x)$ and $\psi_i(x)$ we know that $0 \leq d_\psi \leq g+1$ and $g+1 < d_\phi \leq 2g+2$.
\todo{remove d psi? - will keep for now in case useful later}


We now show that $\frac{-\phi_i}{2yx^{i+1}}dx$ and $\frac{\psi_i}{2yx^{i+1}}dx$ are regular on $U_\infty$ and $U_0$ respectively.
We may assume that $\phi_i$ and $\psi_i$ are non-zero, since the zero function is regular everywhere.
The divisor of $\frac{-\phi_i}{2yx^{i+1}}dx$ is

\begin{align*}
\di\left( \frac{-\phi_i}{2yx^{i+1}}dx \right) & =  \di(\phi_i) -\di(y) - \di(x^{i+1}) + \di (dx) \\
& =  \di(\phi_i) - ( R - (g+1)D_\infty) - ((i+1)D_0 - (i+1)D_\infty) \\
& \qquad + (R - 2D_\infty) \\
& =  \left( \di_0\left( \frac{\phi_i}{x^{g+2}}\right) + (g+2)D_0 - d_\phi D_\infty\right) - (i+1)D_0 + (g+i)D_\infty \\
& \geq  \di_0\left( \frac{\phi_i}{x^{g+2}}\right) + (g+2)D_0 - (2g+2)D_\infty - (i+1)D_0 + (g+i)D_\infty \\
& =  \di_0\left( \frac{\phi_i}{x^{g+2}} \right) + (i-g-2)D_\infty + (g-i+1)D_0,
\end{align*}
where the second equality makes use of \eqref{divxp=2} and \eqref{pnot2divisors}.
Since $i \leq g$ the differential $\frac{-\phi_i}{2yx^{i+1}}dx$ is regular on $U_\infty = X\backslash \pi^{-1}(\infty)$.

Similarly the divisor of $\frac{\psi_i}{2yx^{i+1}}dx$ is

\begin{align*}
\di \left( \frac{\psi_i}{2yx^{i+1}}dx\right) & =  \di(\psi_i) - \di(y) - \di(x^{i+1}) + \di (dx) \\
& =  \di (\psi_i ) -(R - (g+1)D_\infty) - ((i+1)D_0 - (i+1)D_\infty) \\ 
& \qquad + (R -2D_\infty) \\
& =  \di(\psi_i) + (g+i)D_\infty -(i+1)D_0 \\
& =  (\di_0(\psi_i) -d_\psi D_\infty) + (g+i)D_\infty -(i+1)D_0 \\
& \geq \left( \di_0(\psi_i) - (g+1)D_\infty \right) + (g+i)D_\infty -(i+1)D_0 \\
& =  \di_0(\psi_i) + (i-1)D_\infty - (i+1)D_0.
\end{align*}
Again, the second equality uses \eqref{divxp=2} and \eqref{pnot2divisors}, and since $i\geq 1$ we conclude that $\frac{\psi_i(x)}{2yx^{i+1}}dx$ is regular on $U_0 = X \backslash \pi^{-1}(0)$, completing the $p\neq 2$ case.


We now suppose that $p=2$.
We remind the reader that this allows us to change signs between positive and negative as we wish.
We see that
\begin{align*}
\left( \left( \frac{ \Psi_i}{x^{i+1}H} \right) + \left( \frac{\Phi_i}{x^{i+1}H} \right) \right) dx & =  \frac{S_i}{x^{i+1}H}dx \\
& =  \left( \frac{F'}{x^iH} + \frac{yH'}{x^iH} + \frac{iy}{x^{i+1}} \right) dx \\
& =  \frac{1}{x^i}\left( \frac{F' + yH'}{H} \right) dx + \frac{iy}{x^{i+1}}dx \\
& =  x^{-i}dy + yd \left( x^{-i}\right) \\
& =  d\left( yx^{-i}\right),
\end{align*}
with the fourth equality following from \eqref{divdyp=2}.
We have also already seen in the proof of Lemma \ref{basish1} that $\frac{y}{x^i}$ is regular on $U_0 \cap U_\infty$.
So in order to prove that for $i\in \{1, \ldots, g\}$ the elements of \eqref{three} are satisfy the conditions of \eqref{derhamconditions} it only remains to show that the differentials $\frac{\Phi_i}{x^{i+1}H(x)}dx$ and $\frac{\Psi_i}{x^{i+1}H(x)}dx$ are regular on $U_\infty$ and $U_0$ respectively.
We denote the degrees of the polynomials defined in \eqref{Split} by $d_{\Phi}^x, d_{\Psi}^x, d_{\Phi}^y$ and $d_{\Psi}^y$.


By \eqref{Split} $\Phi_i(x,y) = \Phi_i^x(x) + y\Phi_i^y(x)$ and $\Psi_i (x,y)= \Psi_i^x(x) + y\Psi_i^y(x)$, and we will use these splittings to show that $\frac{ \Phi_i(x) }{x^{i+1}H(x)}dx$ and $\frac{\Psi_i(x) }{x^{i+1}H(x)}dx$ are regular on $U_\infty$ and $U_0$ respectively.\todo{note that some stuff was removed before this para}

We start by computing the divisor of $\frac{1}{x^{i+1}H(x)}dx$, since it is a common component to all the differentials we need to look at.
This yields
\begin{align*}
\di \left( \frac{1}{x^{i+1}H(x)}dx \right) & = \di(dx) - \di (x^{i+1}) - \di (H(x)) \nonumber \\
& = (R-2D_\infty) - ((i+1)D_0 - (i+1)D_\infty) - (R - (g+1)D_\infty) \nonumber \\
& = (g+i)D_\infty - (i+1)D_0,
\end{align*}
using \eqref{differentialdivisor}, \eqref{divisorofH} and \eqref{divxp=2}.
We now use this along with Proposition \ref{divyp=2} and the polynomials \eqref{Split} to complete the proof.

We begin by computing the divisors associated to $\Phi_i(x,y)$.
Firstly,
\begin{align*}
\di \left( \frac{\Phi_i^x(x) }{x^{i+1} H(x)}dx \right)  = &  \di(\Phi_i^x(x)) -(i+1)D_0 + (g+i)D_\infty\\
 = & \left( \di_0(\Phi_i^x(x)) -d_\Phi^xD_\infty\right) -(i+1)D_0 + (g+i)D_\infty\\
 \geq & \di_0(\Phi_i^x(x)) - (2g+2)D_\infty - (i+1)D_0 + (g+i)D_\infty \\
 = &  \di_0(\Phi_i^x(x)) - (i+1)D_0 + (i-2-g)D_\infty \\
 =  & \di_0 \left( \frac{\Phi_i^x(x)}{x^{i+1}} \right) + (i-g-2)D_\infty.
\end{align*}
From this we see that the differential $\frac{\Phi_i^x(x)}{x^{i+1}H(x)}dx$ is clearly regular on $U_\infty = X \backslash \pi^{-1}(\infty)$.

We now compute the divisor of the other half of $\frac{\Phi_i(x,y)}{x^{i+1}H(x)}dx$, namely
\begin{align*}
\di\left(\frac{y\Phi_i^y(x) dx}{x^{i+1}H(x)} \right)  = & \di(y) + \di(\Phi_i^y(x)) -(i+1)D_0 + (g+i)D_\infty\\
 = & \di(y) + \di_0(\Phi_i^y(x)) - d_\Phi^yD_\infty -(i+1)D_0 + (g+i)D_\infty \\
 \geq & \di(y) + \di_0(\Phi_i^y(x)) - (g+1)D_\infty - (i+1)D_0 + (g+i)D_\infty \\
 = & \di(y) + \di_0\left(\frac{\Phi_i^y(x)}{x^{i+1}} \right) + (i-1)D_\infty.
\end{align*}
From Proposition \ref{divyp=2} we see that $y$ only has poles at points in $\pi^{-1}(\infty)$, and hence this completes the proof that $\frac{\Phi_i(x,y) }{x^{i+1}H(x)}dx$ is regular on $U_\infty = X \backslash \pi^{-1}(\infty)$.

Now we complete the same computations on $\Psi_i(x,y)$, starting with $\Psi_i^x(x)$:
\begin{align*}
\di\left( \frac{\Psi_i^x(x) }{x^{i+1}H(x)}dx \right)  & =   \di(\Psi_i^x(x))  - (i+1)D_0 + (g+i)D_\infty \\
& = (\di_0(\Psi_i^x(x)) -d_\Psi^xD_\infty) - (i+1)D_0 + (g+i)D_\infty \\
 & \geq   \di_0(\Psi_i^x(x) ) - iD_\infty - (i+1)D_0 + (g+i)D_\infty \\
 & =   \di_0(\Psi_i^x(x)) - (i+1)D_0 + gD_\infty,
\end{align*}
and it is clear that the divisor is positive on $U_0 = X \backslash \pi^{-1}(0)$.

For the other half of the differential we need to consider separate cases.
If we assume that $\infty$ is branch point then  using Proposition \ref{divyp=2} we see that
\begin{align*}
\di\left(\frac{y\Psi_i^y(x) }{x^{i+1}H(x)}dx \right)  =  & \di_0(y) - (2g+1)[P_\infty] + \di(\Psi_i^y(x)) - (i+1)D_0 + (g+i)[P_\infty] \\
 =  & \di_0(y) + \di(\Psi_i^y(x)) -(i+1)D_0 + (2i -1)[P_\infty] \\
 = &  \di_0(y) + \di_0(\Psi_i^y(x)) - d_\Psi^y[P_\infty] - (i+1)D_0 + (2i-1)[P_\infty] \\
 \geq &  \di_0(y) + \di_0(\Psi_i^y(x)) -(i-1)[P_\infty] -(i+1)D_0 + (2i-1)[P_\infty] \\
 =   &\di_0(y) + \di_0(\Psi_i^y(x)) -(i+1)D_0 + [P_\infty],
\end{align*}
which is clearly positive on $U_0$.
On the other hand, if $\infty$ is not a branch point then we have
\begin{align*}
\di\left(\frac{y\Psi_i^y(x) }{x^{i+1}H(x)}dx \right)  =  & \di(y) + \di(\Psi_i^y(x)) - (i+1)D_0 + (g+i)D_\infty \\
= & \di(y) + \di_0(\Psi_i^y(x)) - (i+1)D_0 + (g+i - d_\Psi^y)D_\infty \\
\geq & \di(y) + \di_0(\Psi_i^y(x)) - (i+1)D_0 + (g+1)D_\infty. \\
\end{align*}
Since we know from Proposition \ref{divyp=2} that $y$ cannot have a pole of order greater $g+1$ at $P_\infty$ or $P_\infty'$, and only has poles at these points, it follows that the differential $\frac{y\Psi_i^y(x) }{x^{i+1}H(x)}dx$ is regular on $U_0 = X \backslash \pi^{-1}(0)$.
Thus we have completed the proof.


\end{proof}



























\bibliography{biblio}
\bibliographystyle{amsalpha}
\end{document}
